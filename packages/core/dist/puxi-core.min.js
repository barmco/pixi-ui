/*!
 * @puxi/core - v1.0.1
 * Compiled Sun, 06 Sep 2020 05:01:24 UTC
 *
 * @puxi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
this.PUXI=this.PUXI||{};var _puxi_core=function(t,e,i){"use strict";const s=[],h={add:(t,e)=>(t._dragDropEventId=e.data.identifier,-1===s.indexOf(t)&&(s.push(t),!0)),getItem(t){let e,i=null;for(let h=0;h<s.length;h++)if(s[h]===t){i=s[h],e=h;break}return null!==i&&(s.splice(e,1),i)},getEventItem(t,e){let i,h=null;const n=t.data.identifier;for(let t=0;t<s.length;t++)if(s[t]._dragDropEventId===n){if(e!==s[t].dragGroup)return!1;h=s[t],i=t;break}return null!==h&&(s.splice(i,1),h)}};class n{constructor(){this.reset(),this.dirtyId=0}reset(){this.left=-1,this.top=-1,this.right=-1,this.bottom=-1}}var o;(o=t.MeasureMode||(t.MeasureMode={}))[o.UNBOUNDED=0]="UNBOUNDED",o[o.EXACTLY=1]="EXACTLY",o[o.AT_MOST=2]="AT_MOST";class r{constructor(t){this.target=t,this.isEnabled=!1}getTarget(){return this.target}}class a extends r{constructor(t,i,s,h){super(t),this.startEvent=(t=this._includeHover,e=this._rightMouseButton,i=this._doubleClick)=>{if(this.isEnabled)return;this._includeHover=t,this.rightMouseButton=e,this._doubleClick=i;const{target:s}=this;s.insetContainer.on(this.evMouseDown,this.onMouseDownImpl),this._rightMouseButton||s.insetContainer.on("touchstart",this.onMouseDownImpl),this._includeHover&&(s.insetContainer.on("mouseover",this.onMouseOverImpl),s.insetContainer.on("mouseout",this.onMouseOutImpl)),this.isEnabled=!0},this.stopEvent=()=>{if(!this.isEnabled)return;const{target:t}=this;this.bound&&(t.insetContainer.removeListener(this.evMouseUp,this.onMouseUpImpl),t.insetContainer.removeListener(this.evMouseUpOutside,this.onMouseUpOutsideImpl),this._rightMouseButton||(t.insetContainer.removeListener("touchend",this.onMouseUpImpl),t.insetContainer.removeListener("touchendoutside",this.onMouseUpOutsideImpl)),this.bound=!1),t.insetContainer.removeListener(this.evMouseDown,this.onMouseDownImpl),this._rightMouseButton||t.insetContainer.removeListener("touchstart",this.onMouseDownImpl),this._includeHover&&(t.insetContainer.removeListener("mouseover",this.onMouseOverImpl),t.insetContainer.removeListener("mouseout",this.onMouseOutImpl),t.insetContainer.removeListener("mousemove",this.onMouseMoveImpl),t.insetContainer.removeListener("touchmove",this.onMouseMoveImpl)),this.isEnabled=!1},this.onMouseDownImpl=t=>{const{target:e,evMouseUp:i,onMouseUpImpl:s,evMouseUpOutside:h,onMouseUpOutsideImpl:n,_rightMouseButton:o}=this;if(this.mouse.copyFrom(t.data.global),this.id=t.data.identifier,this.onPress.call(this.target,t,!0),this.bound||(e.insetContainer.on(i,s),e.insetContainer.on(h,n),o||(e.insetContainer.on("touchend",s),e.insetContainer.on("touchendoutside",n)),this.bound=!0),this._doubleClick){const i=performance.now();i-this.time<210?this.onClick.call(e,t):this.time=i}t.data.originalEvent.preventDefault()},this.onMouseUpCommonImpl=t=>{const{target:e,evMouseUp:i,onMouseUpImpl:s,evMouseUpOutside:h,onMouseUpOutsideImpl:n}=this;t.data.identifier===this.id&&(this.offset.set(t.data.global.x-this.mouse.x,t.data.global.y-this.mouse.y),this.bound&&(e.insetContainer.removeListener(i,s),e.insetContainer.removeListener(h,n),this._rightMouseButton||(e.insetContainer.removeListener("touchend",s),e.insetContainer.removeListener("touchendoutside",n)),this.bound=!1),this.onPress.call(e,t,!1))},this.onMouseUpImpl=t=>{t.data.identifier===this.id&&(this.onMouseUpCommonImpl(t),this.target.dragThreshold&&(this.movementX=Math.abs(this.offset.x),this.movementY=Math.abs(this.offset.y),Math.max(this.movementX,this.movementY)>this.target.dragThreshold)||this._doubleClick||this.onClick.call(this.target,t))},this.onMouseUpOutsideImpl=t=>{t.data.identifier===this.id&&this.onMouseUpCommonImpl(t)},this.onMouseOverImpl=t=>{this.ishover||(this.ishover=!0,this.target.insetContainer.on("mousemove",this.onMouseMoveImpl),this.target.insetContainer.on("touchmove",this.onMouseMoveImpl),this.onHover.call(this.target,t,!0))},this.onMouseOutImpl=t=>{this.ishover&&(this.ishover=!1,this.target.insetContainer.removeListener("mousemove",this.onMouseMoveImpl),this.target.insetContainer.removeListener("touchmove",this.onMouseMoveImpl),this.onHover.call(this.target,t,!1))},this.onMouseMoveImpl=t=>{this.onMove.call(this.target,t)},this.bound=!1,this.id=0,this.ishover=!1,this.mouse=new e.Point,this.offset=new e.Point,this.movementX=0,this.movementY=0,this._includeHover=void 0===i||i,this.rightMouseButton=void 0!==s&&s,this._doubleClick=void 0!==h&&h,t.interactive=!0,this.time=0,this.startEvent(),this.onHover=()=>null,this.onPress=()=>null,this.onClick=()=>null,this.onMove=()=>null}get rightMouseButton(){return this._rightMouseButton}set rightMouseButton(t){this._rightMouseButton=t,this.evMouseDown=this._rightMouseButton?"rightdown":"mousedown",this.evMouseUp=this._rightMouseButton?"rightup":"mouseup",this.evMouseUpOutside=this._rightMouseButton?"rightupoutside":"mouseupoutside"}}class d extends r{constructor(t){super(t),this.onDragStartImpl=t=>{const{target:e}=this;this.id=t.data.identifier,this.onPress(t,!0),this.isBound||(this.dragStart.copyFrom(t.data.global),e.stage.on("mousemove",this.onDragMoveImpl),e.stage.on("touchmove",this.onDragMoveImpl),e.stage.on("mouseup",this.onDragEndImpl),e.stage.on("mouseupoutside",this.onDragEndImpl),e.stage.on("touchend",this.onDragEndImpl),e.stage.on("touchendoutside",this.onDragEndImpl),e.stage.on("touchcancel",this.onDragEndImpl),this.isBound=!0),t.data.originalEvent.preventDefault()},this.onDragMoveImpl=t=>{if(t.data.identifier!==this.id)return;const{lastCursor:e,dragOffset:i,dragStart:s,target:h}=this;if(this.lastCursor.copyFrom(t.data.global),this.dragOffset.set(e.x-s.x,e.y-s.y),!this.isDragging){if(this.movementX=Math.abs(i.x),this.movementY=Math.abs(i.y),0===this.movementX&&0===this.movementY||Math.max(this.movementX,this.movementY)<h.dragThreshold)return;if(null!==h.dragRestrictAxis&&(this.cancel=!1,("x"===h.dragRestrictAxis&&this.movementY>this.movementX||"y"===h.dragRestrictAxis&&this.movementY<=this.movementX)&&(this.cancel=!0),this.cancel))return void this.onDragEndImpl(t);this.onDragStart(t),this.isDragging=!0}this.onDragMove(t,i)},this.onDragEndImpl=t=>{if(t.data.identifier!==this.id)return;const{target:e}=this;this.isBound&&(e.stage.removeListener("mousemove",this.onDragMoveImpl),e.stage.removeListener("touchmove",this.onDragMoveImpl),e.stage.removeListener("mouseup",this.onDragEndImpl),e.stage.removeListener("mouseupoutside",this.onDragEndImpl),e.stage.removeListener("touchend",this.onDragEndImpl),e.stage.removeListener("touchendoutside",this.onDragEndImpl),e.stage.removeListener("touchcancel",this.onDragEndImpl),this.isDragging=!1,this.isBound=!1,this.onDragEnd(t),this.onPress(t,!1))},this.isBound=!1,this.isDragging=!1,this.id=0,this.dragStart=new e.Point,this.dragOffset=new e.Point,this.lastCursor=new e.Point,this.movementX=0,this.movementY=0,this.cancel=!1,this.target.interactive=!0,this.onPress=()=>null,this.onDragStart=()=>null,this.onDragMove=()=>null,this.onDragEnd=()=>null,this.startEvent()}startEvent(){if(this.isEnabled)return;const{target:t}=this;t.insetContainer.on("mousedown",this.onDragStartImpl),t.insetContainer.on("touchstart",this.onDragStartImpl),this.isEnabled=!0}stopEvent(){if(!this.isEnabled)return;const{target:t}=this;this.isBound&&(t.stage.removeListener("mousemove",this.onDragMoveImpl),t.stage.removeListener("touchmove",this.onDragMoveImpl),t.stage.removeListener("mouseup",this.onDragEndImpl),t.stage.removeListener("mouseupoutside",this.onDragEndImpl),t.stage.removeListener("touchend",this.onDragEndImpl),t.stage.removeListener("touchendoutside",this.onDragEndImpl),this.isBound=!1),t.insetContainer.removeListener("mousedown",this.onDragStartImpl),t.insetContainer.removeListener("touchstart",this.onDragStartImpl),this.isEnabled=!1}}class l{constructor(t){this.target=t;for(const t of Object.keys(l.MANAGER_MAP))Object.defineProperty(this,t,{get(){return this[`_${t}`]||(this[`_${t}`]=new l.MANAGER_MAP[t](this.target)),this[`_${t}`]}})}}l.MANAGER_MAP={click:a,dnd:d};class u extends r{constructor(t,i=!0){super(t),this.onMouseScrollImpl=t=>{const{target:e,preventDefault:i,delta:s}=this;i&&event.preventDefault(),void 0!==t.deltaX?s.set(t.deltaX,t.deltaY):s.set(1===t.axis?60*t.detail:0,2===t.axis?60*t.detail:0),this.onMouseScroll.call(e,event,s)},this.onHoverImpl=t=>{const{onMouseScrollImpl:e}=this;this.bound||(document.addEventListener("mousewheel",e,!1),document.addEventListener("DOMMouseScroll",e,!1),this.bound=!0)},this.onMouseOutImpl=t=>{const{onMouseScrollImpl:e}=this;this.bound&&(document.removeEventListener("mousewheel",e),document.removeEventListener("DOMMouseScroll",e),this.bound=!1)},this.onMouseScroll=function(t,e){},this.bound=!1,this.delta=new e.Point,this.preventDefault=i,this.startEvent()}startEvent(){const{target:t,onHoverImpl:e,onMouseOutImpl:i}=this;t.contentContainer.on("mouseover",e),t.contentContainer.on("mouseout",i)}stopEvent(){const{target:t,onMouseScrollImpl:e,onHoverImpl:i,onMouseOutImpl:s}=this;this.bound&&(document.removeEventListener("mousewheel",e),document.removeEventListener("DOMMouseScroll",e),this.bound=!1),t.contentContainer.removeListener("mouseover",i),t.contentContainer.removeListener("mouseout",s)}}const c=["paddingLeft","paddingTop","paddingRight","paddingBottom"],g=["paddingHorizontal","paddingVertical"],p=["fontFamily","fontSize","fontWeight","letterSpacing"];class m extends e.utils.EventEmitter{constructor(){super(),this.insetContainer=new e.Container,this.contentContainer=this.insetContainer.addChild(new e.Container),this.widgetChildren=[],this.stage=null,this.layoutMeasure=new n,this.initialized=!1,this.dragInitialized=!1,this.dropInitialized=!1,this.dirty=!0,this._oldWidth=-1,this._oldHeight=-1,this.pixelPerfect=!0,this._paddingLeft=0,this._paddingTop=0,this._paddingRight=0,this._paddingBottom=0,this._elevation=0,this.tint=0,this.blendMode=e.BLEND_MODES.NORMAL,this.draggable=!1,this.droppable=!1,this.singleClickTimeout=null,this.style=null,this.styleID=-1,this.insetContainer.on("pointerdown",t=>{this.onPointerPress(t)}),this.insetContainer.on("pointermove",t=>{this.onPointerMove(t)}),this.insetContainer.on("pointerup",t=>{this.onPointerRelease(t)}),this.insetContainer.on("pointerover",t=>{this.onPointerEnter(t)}),this.insetContainer.on("pointerout",t=>{this.onPointerExit(t)}),this.insetContainer.on("rightclick",t=>{this.onRightClick(t)})}update(){this._layoutDirty&&(console.log("here"),setTimeout(()=>{this._layoutDirty&&this.stage.measureAndLayout()},0)),this.style&&this.styleID!==this.style.dirtyID&&(this.onStyleChange(this.style),this.styleID=this.style.dirtyID)}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}getMeasuredWidth(){return this._measuredWidth}getMeasuredHeight(){return this._measuredHeight}onMeasure(e,i,s,h){const n=this.contentContainer.width+this.paddingHorizontal,o=this.contentContainer.height+this.paddingVertical;switch(s){case t.MeasureMode.EXACTLY:this._measuredWidth=e;break;case t.MeasureMode.UNBOUNDED:this._measuredWidth=n;break;case t.MeasureMode.AT_MOST:this._measuredWidth=Math.min(e,n)}switch(h){case t.MeasureMode.EXACTLY:this._measuredHeight=i;break;case t.MeasureMode.UNBOUNDED:this._measuredHeight=o;break;case t.MeasureMode.AT_MOST:this._measuredHeight=Math.min(i,o)}}measure(t,e,i,s){this.onMeasure(t,e,i,s)}onLayout(t,e=t,i=t,s=e,h=!0){this.layoutMeasure.left=t,this.layoutMeasure.top=e,this.layoutMeasure.right=i,this.layoutMeasure.bottom=s,this._width=i-t,this._height=s-e,this.background&&(this.background.x=0,this.background.y=0,this.background.width=i-t,this.background.height=s-e),this.insetContainer.x=t,this.insetContainer.y=e,this.contentContainer.x=this._paddingLeft,this.contentContainer.y=this._paddingTop,this._layoutDirty=!1}layout(t,e=t,i=t,s=e,h=!0){this.onLayout(t,e,i,s,h)}setLayoutOptions(t){return this.layoutOptions=t,this}onStyleChange(t){const e=t.getProperties("backgroundColor","background","elevation","padding","paddingHorizontal","paddingVertical","paddingLeft","paddingTop","paddingRight","paddingBottom");e.background?this.setBackground(e.background):void 0!==e.backgroundColor&&this.setBackground(e.backgroundColor),void 0!==e.elevation&&this.setElevation(e.elevation),c.forEach((t,i)=>{"number"==typeof e[t]?this[`_${t}`]=e[t]:"number"==typeof e[g[i%2]]?this[`_${t}`]=e[g[i%2]]:"number"==typeof e.padding&&(this[`_${t}`]=e.padding)}),this.dirty=!0}onPointerEnter(t){this.onHoverChange(t,!0)}onPointerExit(t){this.onHoverChange(t,!1)}onPointerPress(t){}onPointerMove(t){}onPointerRelease(t){this.singleClickTimeout?(clearTimeout(this.singleClickTimeout),this.singleClickTimeout=null,setTimeout(()=>{this.onDoubleClick(t)},0)):(this.singleClickTimeout=setTimeout(()=>{this.singleClickTimeout=null},m.CLICK_DELAY),this.onClick(t))}onHoverChange(t,e){}onClick(t){}onDoubleClick(t){}onRightClick(t){if(console.log("RIGHT_CLICK"),t.data.originalEvent.preventDefault(),this.contextMenu){this.contextPopup;t.data.getLocalPosition(this.stage)}}get eventBroker(){return this._eventBroker||(this._eventBroker=new l(this)),this._eventBroker}get paddingLeft(){return this._paddingLeft}set paddingLeft(t){this._paddingLeft=t,this.dirty=!0}get paddingTop(){return this._paddingTop}set paddingTop(t){this._paddingTop=t,this.dirty=!0}get paddingRight(){return this._paddingRight}set paddingRight(t){this._paddingRight=t,this.dirty=!0}get paddingBottom(){return this._paddingBottom}set paddingBottom(t){this._paddingBottom=t,this.dirty=!0}get paddingHorizontal(){return this._paddingLeft+this._paddingRight}get paddingVertical(){return this._paddingTop+this._paddingBottom}get interactive(){return this.insetContainer.interactive}set interactive(t){this.insetContainer.interactive=!0,this.contentContainer.interactive=!0}get width(){return this._width}get height(){return this._height}get contentWidth(){return this._width-this.paddingHorizontal}get contentHeight(){return this._height-this.paddingVertical}get alpha(){return this.insetContainer.alpha}set alpha(t){this.insetContainer.alpha=t}setPadding(t,e=t,i=t,s=e){return this._paddingLeft=t,this._paddingTop=e,this._paddingRight=i,this._paddingBottom=s,this.dirty=!0,this}getBackground(){return this.background}setBackground(t){return this.background&&this.insetContainer.removeChild(this.background),"string"==typeof t&&(t=e.utils.string2hex(t)),"number"==typeof t&&(t=(new e.Graphics).beginFill(t).drawRect(0,0,1,1).endFill()),this.background=t,t&&(t.width=this.width,t.height=this.height,this.insetContainer.addChildAt(t,0)),t&&this._elevation&&this._dropShadow&&(this.background.filters||(this.background.filters=[]),this.background.filters.push(this._dropShadow)),this}getBackgroundAlpha(){return this.background?this.background.alpha:1}setBackgroundAlpha(t){return this.background||this.setBackground(16777215),this.background.alpha=t,this}setContextMenu(t){this.contextMenu=t}getElevation(){return this._elevation}setElevation(t){if(this._elevation=t,0===t&&this._dropShadow){if(!this.background)return this;const t=this.background.filters.indexOf(this._dropShadow);t>0&&this.background.filters.splice(t,1)}else t>0&&(this._dropShadow||(this.background&&!this.background.filters&&(this.background.filters=[]),this._dropShadow=new i.DropShadowFilter({distance:t}),this.background&&this.background.filters.push(this._dropShadow)),this._dropShadow.distance=t);return this}setStyle(t){return this.style=t,this.styleID=-1,this}requestLayout(){this._layoutDirty=!0}addChild(...t){for(let e=0;e<t.length;e++){const i=t[e];i.parent&&i.parent.removeChild(i),i.parent=this,this.contentContainer.addChild(i.insetContainer),this.widgetChildren.push(i)}return this}removeChild(...t){for(let e=0;e<t.length;e++){const i=t[e],s=this.widgetChildren.indexOf(i);-1!==s&&(i.insetContainer.parent.removeChild(i.insetContainer),this.widgetChildren.splice(s,1),i.parent=null)}return this}openPopupMenu(t,e){this.stage;const i=this.contextPopup.layoutOptions;i.x=t,i.y=e,this.stage.addChild(this.contextPopup)}closePopupMenu(){this.stage.removeChild(this.contextPopup)}makeDraggable(){return this.draggable=!0,this.initialized&&this.initDraggable(),this}clearDraggable(){this.dragInitialized&&(this.dragInitialized=!1,this.eventBroker.dnd.stopEvent())}initialize(){this.initialized||(this.draggable&&this.initDraggable(),this.droppable&&this.initDroppable(),this.initialized=!0)}initDraggable(){if(this.dragInitialized)return;this.dragInitialized=!0;const t=new e.Point,i=new e.Point,s=this.eventBroker.dnd,{insetContainer:n}=this;s.onDragStart=e=>{const i=h.add(this,e);!this.isDragging&&i&&(this.isDragging=!0,n.interactive=!1,t.copyFrom(n.position),this.emit("draggablestart",e))},s.onDragMove=(e,s)=>{this.isDragging&&(i.set(t.x+s.x,t.y+s.y),n.x=i.x,n.y=i.y,this.emit("draggablemove",e))},s.onDragEnd=e=>{this.isDragging&&(this.isDragging=!1,h.getItem(this),setTimeout(()=>{this.insetContainer.interactive=!0,this.insetContainer.position.copyFrom(t),this.emit("draggableend",e)},0))}}makeDroppable(){return this.droppable=!0,this.initialized&&this.initDroppable(),this}clearDroppable(){this.dropInitialized&&(this.dropInitialized=!1,this.contentContainer.removeListener("mouseup",this.onDrop),this.contentContainer.removeListener("touchend",this.onDrop))}initDroppable(){if(!this.dropInitialized){this.dropInitialized=!0;const t=this.contentContainer;this.contentContainer.interactive=!0,this.onDrop=t=>{const e=h.getEventItem(t,this.dropGroup);if(e&&e.isDragging){e.isDragging=!1,e.insetContainer.interactive=!0;const t=null!==this.droppableReparent?this.droppableReparent:self;t.container.toLocal(e.container.position,e.container.parent,e),t.container!=e.container.parent&&t.addChild(e)}},t.on("mouseup",this.onDrop),t.on("touchend",this.onDrop)}}static fromContent(t){if(t instanceof m)return t;const e=new m;return e.contentContainer.addChild(t),e}static resolveMeasuredDimen(e,i,s){return s===t.MeasureMode.EXACTLY?i:s===t.MeasureMode.AT_MOST?Math.min(i,e):e}}var f;m.CLICK_DELAY=300,(f=t.ALIGN||(t.ALIGN={}))[f.LEFT=0]="LEFT",f[f.TOP=0]="TOP",f[f.MIDDLE=4081]="MIDDLE",f[f.CENTER=4081]="CENTER",f[f.RIGHT=1048561]="RIGHT",f[f.BOTTOM=1048561]="BOTTOM",f[f.NONE=4294967295]="NONE";class M{constructor(t=M.WRAP_CONTENT,e=M.WRAP_CONTENT){this.setWidth(t),this.setHeight(e),this.cache={}}setWidth(t){this.width=M.parseDimen(t)}setHeight(t){this.height=M.parseDimen(t)}get isWidthPredefined(){return this.width>1&&this.width<=M.MAX_DIMEN}get isHeightPredefined(){return this.height>1&&this.height<=M.MAX_DIMEN}get marginLeft(){return this._marginLeft||0}set marginLeft(t){this._marginLeft=t}get marginTop(){return this._marginTop||0}set marginTop(t){this._marginTop=t}get marginRight(){return this._marginRight||0}set marginRight(t){this._marginRight=t}get marginBottom(){return this._marginBottom||0}set marginBottom(t){this._marginBottom=t}setMargin(t,e,i,s){this._marginLeft=t,this._marginTop=e,this._marginRight=i,this._marginBottom=s}static parseDimen(t){if("string"==typeof t&&(t.endsWith("%")?t=parseFloat(t.replace("%",""))/100:t.endsWith("px")&&(t=parseFloat(t.replace("px",""))),"string"==typeof t||isNaN(t)))throw new Error("Width could not be parsed!");return t}}M.FILL_PARENT=4294967281,M.WRAP_CONTENT=4294967282,M.MAX_DIMEN=4294967280,M.DEFAULT=new M;class C extends M{constructor(t){super(t.width,t.height),this.x=t.x||0,this.y=t.y||0,this.anchor=t.anchor||C.DEFAULT_ANCHOR.clone()}}C.DEFAULT_ANCHOR=new e.Point(0,0),C.CENTER_ANCHOR=new e.Point(.5,.5);class v extends M{constructor(e){super(e.width,e.height),this.region=e.region||v.REGION_CENTER,this.horizontalAlign=e.horizontalAlign||t.ALIGN.LEFT,this.verticalAlign=e.verticalAlign||t.ALIGN.TOP}}v.REGION_LEFT=61425,v.REGION_TOP=61426,v.REGION_RIGHT=61427,v.REGION_BOTTOM=61428,v.REGION_CENTER=61429;class w{onAttach(t){this.host=t}onDetach(){this.host=null}onLayout(){const t=this.host,{contentWidth:e,contentHeight:i,widgetChildren:s}=t;for(let t=0,h=s.length;t<h;t++){const h=s[t],n=h.layoutOptions||M.DEFAULT;let o=n.x?n.x:0,r=n.y?n.y:0;Math.abs(o)<1&&(o*=e),Math.abs(r)<1&&(r*=i);const a=n.anchor||C.DEFAULT_ANCHOR,d=o-a.x*h.getMeasuredWidth(),l=r-a.y*h.getMeasuredHeight();h.layout(d,l,d+h.getMeasuredWidth(),l+h.getMeasuredHeight())}}onMeasure(t,e,i,s){this._measuredWidth=t,this._measuredHeight=e;const h=this.host.widgetChildren;for(let n=0,o=h.length;n<o;n++){const o=h[n],r=o.layoutOptions||M.DEFAULT,a=Math.abs(r.width)<1?r.width*t:r.width,d=Math.abs(r.height)<1?r.height*e:r.height,l=this.getChildMeasureMode(r.width,i),u=this.getChildMeasureMode(r.height,s);o.measure(a,d,l,u)}this._measuredWidth=this.measureWidthReach(t,i),this._measuredHeight=this.measureHeightReach(e,s),this.measureChildFillers()}getChildMeasureMode(e,i){return e===M.WRAP_CONTENT?i===t.MeasureMode.UNBOUNDED?t.MeasureMode.UNBOUNDED:t.MeasureMode.AT_MOST:i}measureWidthReach(e,i){if(i===t.MeasureMode.EXACTLY)return e;const s=this.host.widgetChildren;let h=0;for(let t=0,e=s.length;t<e;t++){const e=s[t],i=e.getMeasuredWidth(),n=e.layoutOptions||M.DEFAULT,o=n.x?n.x:0,r=n.anchor?n.anchor:C.DEFAULT_ANCHOR,a=Math.abs(o)<1?(1-r.x)*i/(1-o):o+i;h=Math.max(h,a)}return i===t.MeasureMode.AT_MOST&&(h=Math.min(e,h)),h}measureHeightReach(e,i){if(i===t.MeasureMode.EXACTLY)return e;const s=this.host.widgetChildren;let h=0;for(let t=0,e=s.length;t<e;t++){const e=s[t],i=e.getMeasuredHeight(),n=e.layoutOptions||M.DEFAULT,o=n.y?n.y:0,r=n.anchor?n.anchor:C.DEFAULT_ANCHOR,a=Math.abs(o)<1?(1-r.y)*i/(1-o):o+i;h=Math.max(h,a)}return i===t.MeasureMode.AT_MOST&&(h=Math.min(e,h)),h}measureChildFillers(){const e=this.host.widgetChildren;for(let i=0,s=e.length;i<s;i++){const s=e[i],h=s.layoutOptions||M.DEFAULT;let n=Math.abs(h.width)<1?h.width*this._measuredWidth:h.width,o=Math.abs(h.height)<1?h.height*this._measuredHeight:h.height;n===M.WRAP_CONTENT&&(n=s.getMeasuredWidth()),o===M.WRAP_CONTENT&&(o=s.getMeasuredHeight()),h.width!==M.FILL_PARENT&&h.height!==M.FILL_PARENT||s.measure(h.width===M.FILL_PARENT?this._measuredWidth:n,h.height===M.FILL_PARENT?this._measuredHeight:o,t.MeasureMode.EXACTLY,t.MeasureMode.EXACTLY)}}getMeasuredWidth(){return this._measuredWidth}getMeasuredHeight(){return this._measuredHeight}}class x extends m{useLayout(t){return this.layoutMgr&&this.layoutMgr.onDetach(),this.layoutMgr=t,t&&this.layoutMgr.onAttach(this),this}useDefaultLayout(){this.useLayout(new w)}onMeasure(t,e,i,s){super.onMeasure(t,e,i,s),0!==this.widgetChildren.length&&(this.layoutMgr||this.useDefaultLayout(),this.layoutMgr.onMeasure(t-this.paddingHorizontal,e-this.paddingVertical,i,s),this._measuredWidth=Math.max(this.measuredWidth,this.layoutMgr.getMeasuredWidth()),this._measuredHeight=Math.max(this.measuredHeight,this.layoutMgr.getMeasuredHeight()))}onLayout(t,e,i,s,h=!0){super.onLayout(t,e,i,s,h),0!==this.widgetChildren.length&&(this.layoutMgr||this.useDefaultLayout(),this.layoutMgr.onLayout())}}class _ extends x{constructor(){super(),this.hitArea=new e.Rectangle,this.insetContainer.hitArea=this.hitArea}update(){super.update()}layout(t,e,i,s,h){super.layout(t,e,i,s,h),this.hitArea.width=this.width,this.hitArea.height=this.height}}class y extends _{constructor(t={}){super(),this.bindEvents=()=>{this.stage.on("pointerdown",this.onDocumentPointerDownImpl),document.addEventListener("keydown",this.onKeyDownImpl)},this.clearEvents=()=>{this.stage.off("pointerdown",this.onDocumentPointerDownImpl),document.removeEventListener("keydown",this.onKeyDownImpl)},this.onKeyDownImpl=t=>{const e=this.stage.focusController;9===t.which&&e.useTab?(e.onTab(),t.preventDefault()):38===t.which&&e.useBack?(e.onBack(),t.preventDefault()):40===t.which&&e.useForward&&(e.onForward(),t.preventDefault()),this.emit("keydown")},this.onDocumentPointerDownImpl=()=>{this._isMousePressed||this.blur()},t.background&&super.setBackground(t.background),this._isFocused=!1,this._isMousePressed=!1,this.interactive=!0,this.tabIndex=t.tabIndex,this.tabGroup=t.tabGroup,this.insetContainer.on("pointerdown",()=>{this.focus(),this._isMousePressed=!0}),this.insetContainer.on("pointerup",()=>{this._isMousePressed=!1}),this.insetContainer.on("pointerupoutside",()=>{this._isMousePressed=!1})}focus(){this.isFocused||(this.stage.focusController.notifyFocus(this),this._isFocused=!0,this.bindEvents(),this.emit("focusChanged",!0),this.emit("focus"))}blur(){this._isFocused&&(this.stage.focusController.notifyBlur(),this._isFocused=!1,this.clearEvents(),this.emit("focusChanged",!1),this.emit("blur"))}get isFocused(){return this._isFocused}initialize(){super.initialize(),this.stage.focusController.in(this,this.tabIndex,this.tabGroup)}}class T extends m{constructor(t,i){super(),this.textDisplay=new e.Text(t,i),this.contentContainer.addChild(this.textDisplay)}update(){super.update(),null!==this.tint&&(this.textDisplay.tint=this.tint),null!==this.blendMode&&(this.textDisplay.blendMode=this.blendMode)}get value(){return this.textDisplay.text}set value(t){this.textDisplay.text=t}get text(){return this.value}set text(t){this.value=t}getTextStyle(){return this.textDisplay.style}setTextStyle(t){return this.textDisplay.style=t,this}onStyleChange(t){super.onStyleChange(t);const e=t.getProperties(...p),i=this.textDisplay.style;p.forEach(t=>{void 0!==e[t]&&(i[t]=e[t])})}}class b extends y{constructor(t){super(t),this.isHover=!1,"string"==typeof t.text&&(t.text=new T(t.text,new e.TextStyle)),this.textWidget=t.text.setLayoutOptions(new C({width:M.WRAP_CONTENT,height:M.WRAP_CONTENT,x:.5,y:.5,anchor:C.CENTER_ANCHOR})),this.textWidget&&this.addChild(this.textWidget),this.contentContainer.buttonMode=!0}onClick(t){super.onClick(t),this.emit("click",t)}onDoubleClick(t){super.onDoubleClick(t),this.emit("doubleclick",t)}update(){super.update()}initialize(){super.initialize(),this.insetContainer.interactiveChildren=!1}get value(){return this.textWidget?this.textWidget.text:""}set value(t){this.textWidget&&(this.textWidget.text=t)}get text(){return this.textWidget}set text(t){this.value=t}onStyleChange(t){this.textWidget.onStyleChange(t)}}class L{getPosition(t){return t}}function E(t,e,i){const s=t,h=e&&i?3:i?1:2;this.getPosition=function(t){let e=1===h?1-t:2===h?t:t<.5?2*t:2*(1-t);return 1===s?e*=e:2===s?e*=e*e:3===s?e*=e*e*e:4===s&&(e*=e*e*e*e),1===h?1-e:2===h?e:t<.5?e/2:1-e/2}}E.prototype=Object.create(L.prototype),E.prototype.constructor=E;const I={},D=.5*Math.PI;function A(t){const e=Object.create(L.prototype);return e.getPosition=t,e}const k=new L;function O(t,e,i){return{easeIn:t,easeOut:e,easeInOut:i}}I.Linear=k,I.Power0={easeNone:k},I.Power1=I.Quad=O(new E(1,1,0),new E(1,0,1),new E(1,1,1)),I.Power2=I.Cubic=O(new E(2,1,0),new E(2,0,1),new E(2,1,1)),I.Power3=I.Quart=O(new E(3,1,0),new E(3,0,1),new E(3,1,1)),I.Power4=I.Quint=O(new E(4,1,0),new E(4,0,1),new E(4,1,1)),I.Bounce={BounceIn:A((function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)})),BounceOut:A((function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375})),BounceInOut:A((function(t){const e=t<.5;return(t=e?1-2*t:2*t-1)<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5}))},I.Circ={CircIn:A((function(t){return-(Math.sqrt(1-t*t)-1)})),CircOut:A((function(t){return Math.sqrt(1-(t-=1)*t)})),CircInOut:A((function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}))},I.Expo={ExpoIn:A((function(t){return Math.pow(2,10*(t-1))-.001})),ExpoOut:A((function(t){return 1-Math.pow(2,-10*t)})),ExpoInOut:A((function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}))},I.Sine={SineIn:A((function(t){return 1-Math.cos(t*D)})),SineOut:A((function(t){return Math.sin(t*D)})),SineInOut:A((function(t){return-.5*(Math.cos(Math.PI*t)-1)}))};const R={Lerp:(t,e,i)=>(i>1?i=1:i<0&&(i=0),t+(e-t)*i),Round(t,e){const i=Math.pow(10,e);return Math.round(t*i)/i},componentToHex(t){const e=t.toString(16);return 1==e.length?`0${e}`:e},rgbToHex(t,e,i){return`#${this.componentToHex(t)}${this.componentToHex(e)}${this.componentToHex(i)}`},rgbToNumber:(t,e,i)=>65536*t+256*e+i,numberToRgb:t=>({r:Math.floor(t/65536),g:Math.floor(t/256)%256,b:t%256}),hexToRgb(t){if(null===t&&(t=16777215),!isNaN(t))return this.numberToRgb(t);t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,i,s){return e+e+i+i+s+s}));const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}};class P extends m{constructor(t){super(),this.spriteDisplay=new e.Sprite(t),this.contentContainer.addChild(this.spriteDisplay)}update(){null!==this.tint&&(this.spriteDisplay.tint=this.tint),null!==this.blendMode&&(this.spriteDisplay.blendMode=this.blendMode)}static fromImage(t){return new P(new e.Texture(new e.BaseTexture(t)))}}const H=P;const{REGION_LEFT:S,REGION_TOP:N,REGION_RIGHT:W,REGION_BOTTOM:B,REGION_CENTER:F}=v,{FILL_PARENT:G}=M,{EXACTLY:V,AT_MOST:U}=t.MeasureMode;class X{constructor(){this.leftWidgets=[],this.topWidgets=[],this.rightWidgets=[],this.bottomWidgets=[],this.centerWidgets=[]}onAttach(t){this.host=t}onDetach(){this.host=null,this.clearMeasureCache(),this.clearRegions()}onLayout(){this.layoutChildren(this.leftWidgets,0,this.measuredTopHeight,this.measuredLeftWidth,this.measuredCenterHeight),this.layoutChildren(this.topWidgets,0,0,this.measuredWidth,this.measuredTopHeight),this.layoutChildren(this.rightWidgets,this.measuredWidth-this.measuredRightWidth,this.measuredTopHeight,this.measuredRightWidth,this.measuredCenterHeight),this.layoutChildren(this.bottomWidgets,0,this.measuredTopHeight+this.measuredCenterHeight,this.measuredWidth,this.measuredBottomHeight),this.layoutChildren(this.centerWidgets,this.measuredLeftWidth,this.measuredTopHeight,this.measuredCenterWidth,this.measuredCenterHeight)}layoutChildren(e,i,s,h,n){var o,r;for(let a=0,d=e.length;a<d;a++){const d=e[a];let l=0,u=0;switch(null===(o=d.layoutOptions)||void 0===o?void 0:o.horizontalAlign){case t.ALIGN.CENTER:l=(h-d.getMeasuredWidth())/2;break;case t.ALIGN.RIGHT:l=h-d.getMeasuredWidth();break;default:l=0}switch(null===(r=d.layoutOptions)||void 0===r?void 0:r.verticalAlign){case t.ALIGN.CENTER:u=(n-d.getMeasuredHeight())/2;break;case t.ALIGN.BOTTOM:u=n-d.getMeasuredHeight();break;default:u=0}l+=i,u+=s,d.layout(l,u,l+d.getMeasuredWidth(),u+d.getMeasuredHeight(),!0)}}onMeasure(e,i,s,h){this.indexRegions(),this.clearMeasureCache();const n=s===t.MeasureMode.EXACTLY?t.MeasureMode.AT_MOST:s,o=h===t.MeasureMode.EXACTLY?t.MeasureMode.AT_MOST:s;let[r,a,,d]=this.measureChildren(this.topWidgets,e,i,n,o),[l,u,,c]=this.measureChildren(this.bottomWidgets,e,i,n,o),[g,p,m,f]=this.measureChildren(this.centerWidgets,e,i,n,h),[M,,C]=this.measureChildren(this.leftWidgets,e,p,n,t.MeasureMode.AT_MOST),[v,,w]=this.measureChildren(this.rightWidgets,e,p,n,t.MeasureMode.AT_MOST);const x=M+v+g,_=Math.max(r,l,x),y=a+u+p;if(s===t.MeasureMode.EXACTLY?this.measuredWidth=e:s===t.MeasureMode.AT_MOST?this.measuredWidth=Math.min(_,e):this.measuredWidth=_,h===t.MeasureMode.EXACTLY?this.measuredHeight=i:h===t.MeasureMode.AT_MOST?this.measuredHeight=Math.min(y,i):this.measuredHeight=y,r=this.measuredWidth,l=this.measuredWidth,y>this.measuredHeight){const t=d+f+c;if(t<this.measuredHeight){const e=(this.measuredHeight-t)/(y-t);a=d+(a-d)*e,u=c+(u-c)*e,p=f+(p-f)*e}else{const t=this.measuredHeight/y;a*=t,u*=t,p*=t}}if(_>this.measuredWidth){const t=C+m+w;if(t<this.measuredWidth){const e=(this.measuredWidth-t)/(_-t);M=C+(M-C)*e,g=m+(g-m)*e,v=w+(v-w)*e}else{const t=this.measuredWidth/_;M*=t,g*=t,v*=t}}this.measuredLeftWidth=M,this.measuredRightWidth=v,this.measuredCenterWidth=g,this.measuredTopHeight=a,this.measuredBottomHeight=u,this.measuredCenterHeight=p,this.fitChildren(this.leftWidgets,this.measuredLeftWidth,this.measuredCenterHeight),this.fitChildren(this.topWidgets,this.measuredWidth,this.measuredTopHeight),this.fitChildren(this.rightWidgets,this.measuredRightWidth,this.measuredCenterHeight),this.fitChildren(this.bottomWidgets,this.measuredWidth,this.measuredBottomHeight),this.fitChildren(this.centerWidgets,this.measuredCenterWidth,this.measuredCenterHeight)}measureChildren(t,e,i,s,h){let n=0,o=0,r=0,a=0;for(let d=0,l=t.length;d<l;d++){const l=t[d],u=l.layoutOptions||M.DEFAULT;let c=e,g=i,p=s,m=h;u.width<=M.MAX_DIMEN&&(c=u.width,p=V,r=Math.max(r,c)),u.height<=M.MAX_DIMEN&&(g=u.height,m=V,a=Math.max(a,g)),l.measure(c,g,p,m),n=Math.max(n,l.getMeasuredWidth()),o=Math.max(o,l.getMeasuredHeight())}return[n,o,r,a]}fitChildren(t,e,i){var s,h,n,o;for(let r=0,a=t.length;r<a;r++){const a=t[r];if(!(a.getMeasuredWidth()<=e&&a.getMeasuredHeight()<=i&&a.getMeasuredWidth()>0&&a.getMeasuredHeight()>0&&(null===(s=a.layoutOptions)||void 0===s?void 0:s.width)!==G&&(null===(h=a.layoutOptions)||void 0===h?void 0:h.height)!==G)&&(e>0&&i>0)){const t=(null===(n=a.layoutOptions)||void 0===n?void 0:n.width)===G?V:U,s=(null===(o=a.layoutOptions)||void 0===o?void 0:o.height)===G?V:U;a.measure(e,i,t,s)}}}indexRegions(){this.clearRegions();const{widgetChildren:t}=this.host;for(let e=0,i=t.length;e<i;e++){const i=t[e];switch((i.layoutOptions||M.DEFAULT).region||F){case S:this.leftWidgets.push(i);break;case N:this.topWidgets.push(i);break;case W:this.rightWidgets.push(i);break;case B:this.bottomWidgets.push(i);break;default:this.centerWidgets.push(i)}}}clearRegions(){this.leftWidgets.length=0,this.topWidgets.length=0,this.rightWidgets.length=0,this.bottomWidgets.length=0}clearMeasureCache(){this.measuredLeftWidth=0,this.measuredRightWidth=0,this.measuredCenterWidth=0,this.measuredTopHeight=0,this.measuredBottomHeight=0,this.measuredCenterHeight=0}getMeasuredWidth(){return this.measuredWidth}getMeasuredHeight(){return this.measuredHeight}}class z{constructor(t="vertical",e="center"){this.orientation=t,this.gravity=e}onAttach(t){this.host=t}onDetach(){this.host=null}onLayout(){let t=0;const e=this.host.widgetChildren,i="vertical"===this.orientation?this.measuredWidth:this.measuredHeight;for(let s=0,h=e.length;s<h;s++){const h=e[s],n="vertical"===this.orientation?h.getMeasuredWidth():h.getMeasuredHeight(),o="vertical"===this.orientation?h.getMeasuredHeight():h.getMeasuredWidth();let r=0;if(n<i)switch(this.gravity){case"center":case"middle":r=(i-n)/2;break;case"right":case"bottom":r=i-n}"vertical"===this.orientation?h.layout(r,t,r+n,t+o):h.layout(t,r,t+o,r+n),t+=o}}onMeasure(e,i,s,h){const n=this.host.widgetChildren,o=s===t.MeasureMode.EXACTLY?t.MeasureMode.AT_MOST:s,r=h===t.MeasureMode.EXACTLY?t.MeasureMode.AT_MOST:h;let a=0,d=0;for(let s=0,h=n.length;s<h;s++){const h=n[s],l=h.layoutOptions||M.DEFAULT,u=l.isWidthPredefined?l.width:e,c=l.isHeightPredefined?l.height:i,g=l.isWidthPredefined?t.MeasureMode.EXACTLY:o,p=l.isHeightPredefined?t.MeasureMode.EXACTLY:r;h.measure(u,c,g,p),"vertical"===this.orientation?(d=Math.max(d,h.getMeasuredWidth()),a+=h.getMeasuredHeight()):(d=Math.max(d,h.getMeasuredHeight()),a+=h.getMeasuredWidth())}"vertical"===this.orientation?(this.measuredWidth=d,this.measuredHeight=a):(this.measuredWidth=a,this.measuredHeight=d)}getMeasuredWidth(){return this.measuredWidth}getMeasuredHeight(){return this.measuredHeight}}class Y extends m{constructor(t){super(),this.percentValue=0,this._disabled=!1,this.fill=t.fill||null,this.percentValue=this._minValue,this._minValue=t.minValue||0,this._maxValue=t.maxValue||100,this.decimals=t.decimals||0,this.orientation=t.orientation||Y.HORIZONTAL,this.onValueChange=t.onValueChange||null,this.onValueChanging=t.onValueChanging||null,this.value=t.value||50,this.track=m.fromContent(t.track||(this.orientation===Y.HORIZONTAL?Y.DEFAULT_HORIZONTAL_TRACK.clone():Y.DEFAULT_VERTICAL_TRACK.clone())),this.handle=m.fromContent(t.handle||Y.DEFAULT_HANDLE.clone()),this.addChild(this.track,this.handle),this._localCursor=new e.Point,this.handle.contentContainer.buttonMode=!0}initialize(){super.initialize();let t,e=0;const i=()=>{this.emit("change",this.value),this._lastChange!=this.value&&(this._lastChange=this.value,"function"==typeof this.onValueChange&&this.onValueChange(this.value))},s=()=>{this.emit("changing",this.value),this._lastChanging!=this.value&&(this._lastChanging=this.value,"function"==typeof this.onValueChanging&&this.onValueChanging(this.value))},h=(t,e)=>{this.percentValue=this.getValueAtPhysicalPosition(t),this.layoutHandle(),s()},n=this.handle.eventBroker.dnd;n.onPress=t=>{t.stopPropagation()},n.onDragStart=()=>{e=this.percentValue,t=this.orientation===Y.HORIZONTAL?this.track.width:this.track.height},n.onDragMove=(i,h)=>{this.percentValue=Math.max(0,Math.min(1,e+(this.orientation===Y.HORIZONTAL?h.x:h.y)/t)),s(),this.layoutHandle()},n.onDragEnd=()=>{i(),this.layoutHandle()};const o=this.track.eventBroker.dnd;o.onPress=(t,e)=>{e&&h(t.data.global),t.stopPropagation()},o.onDragMove=t=>{h(t.data.global)},o.onDragEnd=()=>{i()},this.layoutHandle()}get value(){return R.Round(R.Lerp(this._minValue,this._maxValue,this.percentValue),this.decimals)}set value(t){if(t!==this.value){if(isNaN(t))throw new Error("Cannot use NaN as a value");this.percentValue=(Math.max(this._minValue,Math.min(this._maxValue,t))-this._minValue)/(this._maxValue-this._minValue),"function"==typeof this.onValueChange&&this.onValueChange(this.value),"function"==typeof this.onValueChanging&&this.onValueChanging(this.value),this.handle&&this.initialized&&this.layoutHandle()}}get minValue(){return this._minValue}set minValue(t){this._minValue=t,this.update()}get maxValue(){return this._maxValue}set maxValue(t){this._maxValue=t,this.update()}get disabled(){return this._disabled}set disabled(t){t!==this._disabled&&(this._disabled=t,this.handle.contentContainer.buttonMode=!t,this.handle.contentContainer.interactive=!t,this.track.contentContainer.interactive=!t)}getPhysicalRange(){return this.orientation===Y.HORIZONTAL?this.contentWidth-this.handle.getMeasuredWidth():this.contentHeight-this.handle.getMeasuredHeight()}getValueAtPhysicalPosition(t){const e=this.contentContainer.toLocal(t,null,this._localCursor,!0);let i,s;if(this.orientation===Y.HORIZONTAL){const t=this.handle.getMeasuredWidth();i=e.x-this.paddingLeft-t/4,s=this.contentWidth-t}else{const t=this.handle.getMeasuredHeight();i=e.y-this.paddingTop-t/4,s=this.contentHeight-t}return i/s}layoutHandle(){const t=this.handle,e=t.getMeasuredWidth(),i=t.getMeasuredHeight();let s,h,n=this.width-this.paddingHorizontal,o=this.height-this.paddingVertical;this.orientation===Y.HORIZONTAL?(n-=e,h=(o-i)/2,s=n*this.percentValue):(o-=i,s=(n-e)/2,h=o*this.percentValue),t.layout(s,h,s+e,h+i)}onMeasure(e,i,s,h){const n=(this.orientation===Y.HORIZONTAL?this._maxValue-this._minValue:Math.max(this.handle.contentContainer.width,this.track.contentContainer.width))+this.paddingHorizontal,o=(this.orientation===Y.VERTICAL?this._maxValue-this._minValue:Math.max(this.handle.contentContainer.height,this.track.contentContainer.height))+this.paddingVertical;switch(s){case t.MeasureMode.EXACTLY:this._measuredWidth=e;break;case t.MeasureMode.UNBOUNDED:this._measuredWidth=n;break;case t.MeasureMode.AT_MOST:this._measuredWidth=Math.min(e,n)}switch(h){case t.MeasureMode.EXACTLY:this._measuredHeight=i;break;case t.MeasureMode.UNBOUNDED:this._measuredHeight=o;break;case t.MeasureMode.AT_MOST:this._measuredHeight=Math.min(i,o)}}onLayout(e,i,s,h,n){super.onLayout(e,i,s,h,n);const{handle:o,track:r}=this;r.layout(0,0,this.width-this.paddingHorizontal,this.height-this.paddingVertical),r.insetContainer.width=r.width,r.insetContainer.height=r.height,o.measure(this.width,this.height,t.MeasureMode.AT_MOST,t.MeasureMode.AT_MOST),this.layoutHandle()}}Y.DEFAULT_HORIZONTAL_TRACK=(new e.Graphics).beginFill(16777215,1).drawRect(0,0,16,16).endFill().lineStyle(1,0,.7,1,!0).moveTo(1,8).lineTo(15,8),Y.DEFAULT_VERTICAL_TRACK=(new e.Graphics).beginFill(16777215,1).drawRect(0,0,16,16).endFill().lineStyle(1,0,.7,1,!0).moveTo(8,1).lineTo(8,15),Y.DEFAULT_HANDLE=(new e.Graphics).beginFill(0).drawCircle(16,16,8).endFill().beginFill(0,.5).drawCircle(16,16,16).endFill(),Y.HORIZONTAL=4085,Y.VERTICAL=4094;const j=[],K=[],$={},Z={};let q=1;class Q{constructor(t){this.object=t,this.tweens={},this.active=!1,this.onUpdate=null}}class J{constructor(){this._ready=!1,this.obj=null,this.parent=null,this.key="",this.time=0,this.callback=null,this.currentTime=0}remove(){this._ready=!0,delete this.parent.tweens[this.key],Object.keys(this.parent.tweens).length||(this.parent.active=!1,this.parent.onUpdate=null,delete Z[this.obj._tweenObjectId])}set(t,e,i){this.obj=t.object,this.obj._currentCallbackID?this.obj._currentCallbackID++:this.obj._currentCallbackID=1,this.time=i,this.parent=t,this.callback=e,this._ready=!1,this.key=`cb_${this.obj._currentCallbackID}`,this.currentTime=0,this.parent.active||(this.parent.active=!0,Z[this.obj._tweenObjectId]=this.parent)}update(t){this.currentTime+=t,this.currentTime>=this.time&&(this.remove(),this.callback.call(this.parent))}}class tt{constructor(){this._ready=!1,this.parent=null,this.obj=null,this.key="",this.from=0,this.to=0,this.time=0,this.ease=0,this.currentTime=0,this.t=0,this.isColor=!1}remove(){this._ready=!0,delete this.parent.tweens[this.key],Object.keys(this.parent.tweens).length||(this.parent.active=!1,delete Z[this.obj._tweenObjectId])}set(t,e,i,s,h,n){this.isColor=isNaN(i)&&"#"===i[0]||isNaN(s)&&"#"===s[0],this.parent=t,this.obj=t.object,this.key=e,this.surfix=function(t){if(isNaN(t)&&-1!==t.indexOf("%"))return"%"}(s),this.isColor?(this.to=R.hexToRgb(s),this.from=R.hexToRgb(i),this.currentColor={r:this.from.r,g:this.from.g,b:this.from.b}):(this.to=function(t){if(!isNaN(t))return t;if(isNaN(t)&&-1!==t.indexOf("%"))return parseFloat(t.replace("%",""))}(s),this.from=function(t,e,i,s){if(!isNaN(t)&&!isNaN(e))return t;if(isNaN(t)&&isNaN(e)&&-1!==t.indexOf("%")&&-1!==e.indexOf("%"))return parseFloat(t.replace("%",""));if(isNaN(t)&&!isNaN(e)&&-1!==t.indexOf("%"))return-1!==et.indexOf(s)?i.parent._width*(.01*parseFloat(t.replace("%",""))):-1!==it.indexOf(s)?i.parent._height*(.01*parseFloat(t.replace("%",""))):0;if(!isNaN(t)&&isNaN(e)&&-1!==e.indexOf("%"))return-1!==et.indexOf(s)?t/i.parent._width*100:-1!==it.indexOf(s)?t/i.parent._height*100:0;return 0}(i,s,this.obj,e)),this.time=h,this.currentTime=0,this.ease=n,this._ready=!1,this.parent.active||(this.parent.active=!0,Z[this.obj._tweenObjectId]=this.parent)}update(t){if(this.currentTime+=t,this.t=Math.min(this.currentTime,this.time)/this.time,this.ease&&(this.t=this.ease.getPosition(this.t)),this.isColor)this.currentColor.r=Math.round(R.Lerp(this.from.r,this.to.r,this.t)),this.currentColor.g=Math.round(R.Lerp(this.from.g,this.to.g,this.t)),this.currentColor.b=Math.round(R.Lerp(this.from.b,this.to.b,this.t)),this.obj[this.key]=R.rgbToNumber(this.currentColor.r,this.currentColor.g,this.currentColor.b);else{const t=R.Lerp(this.from,this.to,this.t);this.obj[this.key]=this.surfix?t+this.surfix:t}this.currentTime>=this.time&&this.remove()}}const et=["width","minWidth","maxWidth","anchorLeft","anchorRight","left","right","x"],it=["height","minHeight","maxHeight","anchorTop","anchorBottom","top","bottom","y"];function ht(t){t._tweenObjectId||(t._tweenObjectId=q,q++);let e=$[t._tweenObjectId];return e||(e=$[t._tweenObjectId]=new Q(t)),e}function nt(){for(let t=0;t<j.length;t++)if(j[t]._ready)return j[t];const t=new tt;return j.push(t),t}function ot(){for(let t=0;t<K.length;t++)if(K[t]._ready)return K[t];const t=new J;return K.push(t),t}const rt={to(t,e,i,s){const h=ht(t);let n=null;for(const o in i)if("onComplete"!==o)if("onUpdate"!==o){if(e){const n=i[o]===t[o];if(void 0===t[o])continue;n?h.tweens[o]&&h.tweens[o].remove():(h.tweens[o]||(h.tweens[o]=nt()),h.tweens[o].set(h,o,t[o],i[o],e,s))}}else n=i[o];else{const t=ot();t.set(h,i[o],e),h.tweens[t.key]=t}e?h.onUpdate=n:this.set(t,i)},from(t,e,i,s){const h=ht(t);let n=null;for(const o in i)if("onComplete"!==o)if("onUpdate"!==o){if(e){const n=i[o]==t[o];if(void 0===t[o])continue;n?h.tweens[o]&&h.tweens[o].remove():(h.tweens[o]||(h.tweens[o]=nt()),h.tweens[o].set(h,o,i[o],t[o],e,s))}}else n=i[o];else{const t=ot();t.set(h,i[o],e),h.tweens[t.key]=t}e?h.onUpdate=n:this.set(t,i)},fromTo(t,e,i,s,h){const n=ht(t);let o=null;for(const r in s)if("onComplete"!==r)if("onUpdate"!==r){if(e){const o=i[r]==s[r];if(void 0===t[r]||void 0===i[r])continue;o?(n.tweens[r]&&n.tweens[r].remove(),t[r]=s[r]):(n.tweens[r]||(n.tweens[r]=nt()),n.tweens[r].set(n,r,i[r],s[r],e,h))}}else o=s[r];else{const t=ot();t.set(n,s[r],e),n.tweens[t.key]=t}e?n.onUpdate=o:this.set(t,s)},set(t,e){const i=ht(t);for(const s in e)void 0!==t[s]&&(i.tweens[s]&&i.tweens[s].remove(),t[s]=e[s])},_update(t){for(const e in Z){const i=Z[e];for(const e in i.tweens)i.tweens[e].update(t);i.onUpdate&&i.onUpdate.call(i.object,t)}}};class at extends Y{constructor(t){super({track:t.track||at.DEFAULT_TRACK.clone(),handle:t.handle||at.DEFAULT_HANDLE.clone(),fill:null,orientation:t.orientation,minValue:0,maxValue:1}),this.scrollingContainer=t.scrollingContainer,this.autohide=t.autohide,this._hidden=!1}initialize(){super.initialize(),this.decimals=3,this.on("changing",()=>{this.scrollingContainer.forcePctPosition(this.orientation===Y.HORIZONTAL?"x":"y",this.percentValue)}),this.on("change",()=>{this.scrollingContainer.setScrollPosition()})}toggleHidden(t){this.autohide&&(t&&!this._hidden?(rt.to(this,.2,{alpha:0}),this._hidden=!0):!t&&this._hidden&&(rt.to(this,.2,{alpha:1}),this._hidden=!1))}}at.DEFAULT_TRACK=(new e.Graphics).beginFill(16777215).drawRect(0,0,8,8).endFill(),at.DEFAULT_HANDLE=(new e.Graphics).beginFill(0).drawCircle(8,8,4).endFill().beginFill(0,.5).drawCircle(8,8,8).endFill();class dt extends _{constructor(i={}){if(super(),this.forcePctPosition=(t,e)=>{const i=this.getInnerBounds(),s=this.innerContainer.insetContainer;this.scrollX&&"x"===t&&(s.position[t]=-(i.width-this.width)*e),this.scrollY&&"y"===t&&(s.position[t]=-(i.height-this.height)*e),this.scrollPosition[t]=this.targetPosition[t]=s.position[t]},this.focusPosition=t=>{const e=this.getInnerBounds(),i=this.innerContainer.insetContainer;let s;if(this.scrollX){const h=Math.max(0,Math.min(e.width,t.x));h+i.x>this.width?(s=h-this.width,i.x=-s):h+i.x<0&&(s=h+i.x,i.x-=s)}if(this.scrollY){const h=Math.max(0,Math.min(e.height,t.y));h+i.y>this.height?(s=h-this.height,i.y=-s):h+i.y<0&&(s=h+i.y,i.y-=s)}this.lastPosition.copyFrom(i.position),this.targetPosition.copyFrom(i.position),this.scrollPosition.copyFrom(i.position),this.updateScrollBars()},this.setScrollPosition=t=>{t&&this.scrollVelocity.copyFrom(t);const i=this.innerContainer.insetContainer;this.animating||(this.animating=!0,this.lastPosition.copyFrom(i.position),this.targetPosition.copyFrom(i.position),e.Ticker.shared.add(this.updateScrollPosition))},this.updateScrollPosition=t=>{this.stop=!0,this.scrollX&&this.updateDirection("x",t),this.scrollY&&this.updateDirection("y",t),this.stop&&(e.Ticker.shared.remove(this.updateScrollPosition),this.animating=!1),this.updateScrollBars()},this.updateDirection=(t,e)=>{const i=this.getInnerBounds(),{scrollPosition:s,scrollVelocity:h,targetPosition:n,lastPosition:o}=this,r=this.innerContainer.insetContainer;let a;if(a="y"===t?Math.round(Math.min(0,this.height-i.height)):Math.round(Math.min(0,this.width-i.width)),this.scrolling||0===Math.round(h[t])||(n[t]+=h[t],h[t]=R.Lerp(h[t],0,(5+2.5/Math.max(this.softness,.01))*e),n[t]>0?n[t]=0:n[t]<a&&(n[t]=a)),!this.scrolling&&0===Math.round(h[t])&&(r[t]>0||r[t]<a)){const i=this.scrollPosition[t]>0?0:a;s[t]=R.Lerp(s[t],i,(40-30*this.softness)*e),this.stop=!1}else(this.scrolling||0!==Math.round(h[t]))&&(this.scrolling&&(h[t]=this.scrollPosition[t]-o[t],o.copyFrom(s)),n[t]>0?(h[t]=0,s[t]=100*this.softness*(1-Math.exp(n[t]/-200))):n[t]<a?(h[t]=0,s[t]=a-100*this.softness*(1-Math.exp((a-n[t])/-200))):s[t]=n[t],this.stop=!1);r.position[t]=Math.round(s[t])},this.mask=new e.Graphics,this.innerContainer=new _,this.innerBounds=new e.Rectangle,super.addChild(this.innerContainer),this.contentContainer.addChild(this.mask),this.contentContainer.mask=this.mask,this.scrollX=void 0!==i.scrollX&&i.scrollX,this.scrollY=void 0!==i.scrollY&&i.scrollY,this.dragScrolling=void 0===i.dragScrolling||i.dragScrolling,this.softness=void 0!==i.softness?Math.max(Math.min(i.softness||0,1),0):.5,this.radius=i.radius||0,this.expandMask=i.expandMask||0,this.overflowY=i.overflowY||0,this.overflowX=i.overflowX||0,this.scrollVelocity=new e.Point,this.scrollPosition=new e.Point,this.targetPosition=new e.Point,this.lastPosition=new e.Point,this.useLayout(new X),this.animating=!1,this.scrolling=!1,this.scrollBars=[],i.scrollBars&&this.scrollX){const e=new at({orientation:at.HORIZONTAL,scrollingContainer:this,minValue:0,maxValue:1}).setLayoutOptions(new v({width:M.FILL_PARENT,height:M.WRAP_CONTENT,region:v.REGION_BOTTOM,horizontalAlign:t.ALIGN.CENTER,verticalAlign:t.ALIGN.BOTTOM})).setBackground(255).setBackgroundAlpha(.8);super.addChild(e),this.scrollBars.push(e)}if(i.scrollBars&&this.scrollY){const e=new at({orientation:at.VERTICAL,scrollingContainer:this,minValue:0,maxValue:1}).setLayoutOptions(new v({width:M.WRAP_CONTENT,height:M.FILL_PARENT,region:v.REGION_RIGHT,horizontalAlign:t.ALIGN.RIGHT,verticalAlign:t.ALIGN.CENTER})).setBackground(255).setBackgroundAlpha(.8);super.addChild(e),this.scrollBars.push(e)}this.boundCached=0}update(){if(super.update(),this.lastWidth!==this.width||this.lastHeight!==this.height){const t=this.expandMask;this.mask.clear(),this.mask.lineStyle(0),this.mask.beginFill(16777215,1),0===this.radius?this.mask.drawRect(-t,-t,this.width+t,this.height+t):this.mask.drawRoundedRect(-t,-t,this.width+t,this.height+t,this.radius),this.mask.endFill(),this.lastWidth=this.width,this.lastHeight=this.height}}addScrollBar(t){return super.addChild(t),this.scrollBars.push(t),this}addChild(...t){for(let e=0;e<t.length;e++)this.innerContainer.addChild(t[e]);return this.getInnerBounds(!0),this}updateScrollBars(){for(let t=0,e=this.scrollBars.length;t<e;t++){const e=this.scrollBars[t];if(e.orientation===Y.HORIZONTAL){const t=this.getPercentPosition("x");e.value=t}else if(e.orientation===Y.VERTICAL){const t=this.getPercentPosition("y");e.value=t}}}getInnerBounds(t){return(t||performance.now()-this.boundCached>1e3)&&(this.innerContainer.insetContainer.getLocalBounds(this.innerBounds),this.innerBounds.height=this.innerBounds.y+this.innerContainer.height||0,this.innerBounds.width=this.innerBounds.x+this.innerContainer.width||0,this.boundCached=performance.now()),this.innerBounds}initialize(){super.initialize(),(this.scrollX||this.scrollY)&&this.initScrolling()}initScrolling(){const t=this.innerContainer.insetContainer,i=new e.Point,{scrollPosition:s,targetPosition:h}=this;if(this.dragScrolling){const e=this.eventBroker.dnd;e.onDragStart=e=>{this.scrolling||(i.copyFrom(t.position),s.copyFrom(t.position),this.scrolling=!0,this.setScrollPosition(),this.emit("scrollstart",e))},e.onDragMove=(t,e)=>{this.scrollX&&(h.x=i.x+e.x),this.scrollY&&(h.y=i.y+e.y),this.setScrollPosition()},e.onDragEnd=t=>{this.scrolling&&(this.scrolling=!1,this.emit("scrollend",t))}}const n=new e.Point;new u(this,!0).onMouseScroll=(t,e)=>{n.set(.2*-e.x,.2*-e.y),this.setScrollPosition(n)},this.updateScrollBars()}getPercentPosition(t){const e=this.getInnerBounds(),i=this.innerContainer.insetContainer;return"x"===t?i.x/(this.width-e.width):"y"===t?i.y/(this.height-e.height):0}}class lt extends e.utils.EventEmitter{constructor(t){super(),this.stage=t}}class ut extends e.Container{constructor(t,i){super(),this.__width=t,this.__height=i,this.minWidth=0,this.minHeight=0,this.widgetChildren=[],this.interactive=!0,this.stage=this,this.hitArea=new e.Rectangle(0,0,0,0),this.initialized=!0,this.resize(t,i),this._checkBoxGroupCtl=new ut.CHECK_BOX_GROUP_CONTROLLER(this),this._focusCtl=new ut.FOCUS_CONTROLLER(this)}measureAndLayout(){this.background&&(this.background.width=this.width,this.background.height=this.height);for(let e=0,i=this.widgetChildren.length;e<i;e++){const i=this.widgetChildren[e],s=i.layoutOptions||M.DEFAULT,h=s.width<M.MAX_DIMEN?t.MeasureMode.EXACTLY:t.MeasureMode.AT_MOST,n=s.height<M.MAX_DIMEN?t.MeasureMode.EXACTLY:t.MeasureMode.AT_MOST,o=Math.abs(s.width)<1?s.width*this.width:s.width,r=Math.abs(s.height)<1?s.height*this.height:s.height;i.measure(h===t.MeasureMode.EXACTLY?o:this.width,n===t.MeasureMode.EXACTLY?r:this.height,h,n);let a=s.x?s.x:0,d=s.y?s.y:0;Math.abs(a)<1&&(a*=this.width),Math.abs(d)<1&&(d*=this.height);const l=s.anchor||C.DEFAULT_ANCHOR,u=a-l.x*i.getMeasuredWidth(),c=d-l.y*i.getMeasuredHeight();i.layout(u,c,u+i.getMeasuredWidth(),c+i.getMeasuredHeight(),!0)}}getBackground(){return this.background}setBackground(t){this.background&&super.removeChild(this.background),this.background=t,t&&(super.addChildAt(t,0),this.background.width=this.width,this.background.height=this.height)}update(t){this.emit("preupdate",this);for(let e=0,i=t.length;e<i;e++){const i=t[e];i.stage=this,i.initialized||i.initialize(),this.update(i.widgetChildren),i.update()}this.emit("postupdate",this)}render(t){this.update(this.widgetChildren),super.render(t)}addChild(t){const e=arguments.length;if(e>1)for(let t=0;t<e;t++)this.addChild(arguments[t]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.widgetChildren.push(t),super.addChild(t.insetContainer);this.measureAndLayout()}removeChild(t){const e=arguments.length;if(e>1)for(let t=0;t<e;t++)this.removeChild(arguments[t]);else{super.removeChild(t.insetContainer);const e=this.widgetChildren.indexOf(t);-1!==e&&(this.children.splice(e,1),t.parent=null)}this.measureAndLayout()}resize(t,e){this.width=t,this.height=e,this.hitArea&&(this.hitArea.width=this.__width,this.hitArea.height=this.__height),this.measureAndLayout()}get width(){return this.__width}set width(t){isNaN(t)||(this.__width=t,this.resize())}get height(){return this.__height}set height(t){isNaN(t)||(this.__height=t,this.resize())}get checkBoxGroupController(){return this._checkBoxGroupCtl}get focusController(){return this._focusCtl}}ut.CHECK_BOX_GROUP_CONTROLLER=class extends lt{constructor(t){super(t),this.checkGroups=new Map}in(t,e){if(!e)throw new Error("Default check groups don't exist!");(this.checkGroups.get(e)||this.initGroup(e)).checks.push(t),t.checkGroup=e}out(t){const e=this.checkGroups.get(t.checkGroup),i=e.checks.indexOf(t);i>0&&e.checks.splice(i,1),t.checkGroup=null}notifyCheck(t){const e=this.checkGroups.get(t.checkGroup);if(!e)return;const{checks:i}=e;for(let e=0,s=i.length;e<s;e++)i[e]!==t&&(i[e].checked=!1);e.selected=t}getSelected(t){var e;return null===(e=this.checkGroups.get(t))||void 0===e?void 0:e.selected}initGroup(t){const e={checks:[],selected:null};return this.checkGroups.set(t,e),e}},ut.FOCUS_CONTROLLER=class extends lt{constructor(t){super(t),this.tabGroups=new Map,this.useTab=!0,this.useForward=!0,this.useBack=!0}in(t,e=0,i="default"){let s=this.tabGroups.get(i);s||(s=[],this.tabGroups.set(i,s)),-1===s.indexOf(t)&&(t.tabIndex=void 0!==e?e:-1,t.tabGroup=i,s.push(t),s.sort((t,e)=>t.tabIndex-e.tabIndex))}out(t){const e=this.tabGroups.get(t.tabGroup);if(!e)return;const i=e.indexOf(t);-1!==i&&e.splice(i,1)}notifyFocus(t){const e=this.currentItem;e&&(e.blur(),this.emit("blur",e)),this.currentItem=t,this.emit("focus",t),this.emit("focusChanged",t,e)}notifyBlur(){this.emit("blur",this.currentItem),this.emit("focusChanged",null,this.currentItem),this.currentItem=null}focus(t){const e=this.currentItem;e&&(e.blur(),this.emit("blur",e)),t.focus(),this.emit("focus",t),this.emit("focusChanged",t,e)}blur(){this.currentItem&&(this.currentItem.blur(),this.emit("blur",this.currentItem),this.emit("focusChanged",null,this.currentItem),this.currentItem=null)}onTab(){const{tabGroups:t,currentItem:e}=this;if(e){const i=t.get(e.tabGroup);let s=i.indexOf(e)+1;s>=i.length&&(s=0),this.focus(i[s])}}onForward(){if(!this.useForward)return;const{currentItem:t,tabGroups:e}=this;if(t){const i=e.get(t.tabGroup);let s=i.indexOf(t)+1;s>=i.length&&(s=i.length-1),this.focus(i[s])}}onBack(){const{currentItem:t,tabGroups:e}=this;if(t){const i=e.get(t.tabGroup);let s=i.indexOf(t)-1;s<0&&(s=0),this.focus(i[s])}}};class ct extends e.utils.EventEmitter{constructor(t={}){super(),this.onParentSetProperty=(t,e,i)=>{const s=this.extends,h=s.indexOf(i);if(-1===h)throw new Error("onParentSetProperty triggered when by a non-super style.");const n=this.computedData[t];for(let e=h,i=s.length;e<i;e++){const i=s[e];i.computedData[t]&&(this.computedData[t]=i.computedData[t])}this.data[t]&&(this.computedData[t]=this.data[t]),n!==this.computedData[t]&&this.emit("setProperty",t,this.computedData[t],this)},this.dirtyID=0,this.data=t,this.extends=[],this.computedData=t,this.computedDirty=!1}getProperty(t){return this.computedDirty&&this.compute(),this.computedData[t]}getProperties(...t){this.computedDirty&&this.compute();const e={};for(let i=0,s=t.length;i<s;i++)e[t[i]]=this.computedData[t[i]];return e}setProperty(t,e){this.computedDirty&&this.compute(),this.data[t]=e,this.computedData[t]=e,this.emit("setProperty",t,e,this),++this.dirtyID}extend(t){this.extends.push(t),this.computedDirty=!0,++this.dirtyID,t.on("setProperty",this.onParentSetProperty)}compute(){const t=this.extends;this.computedData={};for(let e=0,i=t.length;e<i;e++)Object.assign(this.computedData,t[e].computedData);this.computedDirty=!1}static create(t){return new ct(t)}}class gt{static create(t){const e=new gt;for(const i in t)e[i]=ct.create(t[i]);return e}}let pt;class mt extends e.utils.EventEmitter{constructor(t){super(),this._disabled=!0,this._now=0,this.DeltaTime=0,this.Time=performance.now(),this.Ms=0,t&&(this.disabled=!1),mt.shared=this}get disabled(){return this._disabled}set disabled(t){this._disabled?(this._disabled=!1,mt.shared=this,this.update(performance.now(),!0)):this._disabled=!0}update(t){mt.shared._now=t,mt.shared.Ms=mt.shared._now-mt.shared.Time,mt.shared.Time=mt.shared._now,mt.shared.DeltaTime=.001*mt.shared.Ms,mt.shared.emit("update",mt.shared.DeltaTime),rt._update(mt.shared.DeltaTime),mt.shared._disabled||requestAnimationFrame(mt.shared.update)}static on(t,e,i){mt.shared.on(t,e,i)}static once(t,e,i){mt.shared.once(t,e,i)}static removeListener(t,e){mt.shared.removeListener(t,e)}}return mt.shared=new mt(!0),t.AnchorLayout=class{onAttach(t){this.host=t}onDetach(){this.host=null}onLayout(){const e=this.host,{widgetChildren:i}=e,s=e.contentWidth,h=e.contentHeight;for(let e=0;e<i.length;e++){const n=i[e],o=n.layoutOptions||{},r=n.getMeasuredWidth(),a=n.getMeasuredHeight(),d=this.calculateAnchor(o.anchorLeft||0,s,!1),l=this.calculateAnchor(o.anchorTop||0,h,!1),u=this.calculateAnchor(o.anchorRight||0,s,!0),c=this.calculateAnchor(o.anchorBottom||0,h,!0);let g=d,p=l;switch(o.horizontalAlign){case t.ALIGN.MIDDLE:g=(u+d-r)/2;break;case t.ALIGN.RIGHT:g=u-r}switch(o.verticalAlign){case t.ALIGN.MIDDLE:p=(c+l-a)/2;break;case t.ALIGN.BOTTOM:p=c-a}n.layout(g,p,g+r,p+a)}}onMeasure(e,i,s,h){const n=this.host.widgetChildren;let o=0,r=0;const a=s===t.MeasureMode.EXACTLY?t.MeasureMode.AT_MOST:s,d=h===t.MeasureMode.EXACTLY?t.MeasureMode.AT_MOST:h;let l=!1;for(let s=0,h=n.length;s<h;s++){const h=n[s],u=h.layoutOptions||M.DEFAULT;if(u.width===M.FILL_PARENT)throw new Error("AnchorLayout does not support width = FILL_PARENT. Use anchorLeft = 0 & anchorRight = 0");if(u.height===M.FILL_PARENT)throw new Error("AnchorLayout does not support height = FILL_PARENT. Use anchorTop = 0 & anchorBottom = 0");const c=this.calculateAnchor(u.anchorLeft||0,e,!1),g=this.calculateAnchor(u.anchorTop||0,i,!1),p=this.calculateAnchor(u.anchorRight||0,e,!0),m=this.calculateAnchor(u.anchorBottom||0,i,!0),f=u.isWidthPredefined,C=u.isHeightPredefined,v=f?u.width:p-c,w=C?u.height:m-g,x=f?t.MeasureMode.EXACTLY:a,_=C?t.MeasureMode.EXACTLY:d;l=l||0===u.width||0===u.height,h.measure(v,w,x,_);const y=this.calculateReach(u.anchorLeft||0,u.anchorRight||0,h.getMeasuredWidth()),T=this.calculateReach(u.anchorTop||0,u.anchorBottom||0,h.getMeasuredHeight());o=Math.max(o,y),r=Math.max(r,T)}if(this.measuredWidth=m.resolveMeasuredDimen(o,e,s),this.measuredHeight=m.resolveMeasuredDimen(r,i,h),l)for(let e=0,i=n.length;e<i;e++){const i=n[e],s=i.layoutOptions||M.DEFAULT;if(0===s.width||0===s.height){const e=this.calculateAnchor(s.anchorLeft||0,this.measuredWidth,!1),h=this.calculateAnchor(s.anchorTop||0,this.measuredHeight,!1),n=this.calculateAnchor(s.anchorRight||0,this.measuredWidth,!0),o=this.calculateAnchor(s.anchorBottom||0,this.measuredHeight,!0);i.measure(s.isWidthPredefined?s.width:n-e,s.isHeightPredefined?s.height:o-h,0===s.width||s.isWidthPredefined?t.MeasureMode.EXACTLY:t.MeasureMode.AT_MOST,0===s.height||s.isHeightPredefined?t.MeasureMode.EXACTLY:t.MeasureMode.AT_MOST)}}}getMeasuredWidth(){return this.measuredWidth}getMeasuredHeight(){return this.measuredHeight}calculateAnchor(t,e,i){const s=Math.abs(t)<1?t*e:t;return i?e-s:s}calculateReach(t,e,i){return Math.abs(t)<1&&Math.abs(e)<1?i/(1-e-t):Math.abs(t)<1?(e+i)/(1-t):Math.abs(e)<1?(t+i)/(1-e):t+i+e}},t.AnchorLayoutOptions=class extends M{constructor(e){super(e.width,e.height),this.anchorLeft=e.anchorLeft||0,this.anchorTop=e.anchorTop||0,this.anchorBottom=e.anchorBottom||0,this.anchorRight=e.anchorRight||0,this.horizontalAlign=e.horizontalAlign||t.ALIGN.LEFT,this.verticalAlign=e.verticalAlign||t.ALIGN.CENTER}},t.BorderLayout=X,t.BorderLayoutOptions=v,t.Button=b,t.CheckBox=class extends y{constructor(t){super(t),this.change=t=>{this.checkmark&&(this.checkmark.alpha=t?1:0)},this.click=()=>{this.emit("click"),null!==this.checkGroup&&this.checked||(this.checked=!this.checked,this.emit("changed",this.checked))},this._checked=void 0!==t.checked&&t.checked,this._value=t.value||"",this.checkGroup=t.checkGroup||null,this.checkmark=new _,this.checkmark.contentContainer.addChild(t.checkmark),this.checkmark.setLayoutOptions(new C({width:M.WRAP_CONTENT,height:M.WRAP_CONTENT,x:.5,y:.5,anchor:C.CENTER_ANCHOR})),this.checkmark.alpha=this._checked?1:0,this.addChild(this.checkmark),this.contentContainer.buttonMode=!0}update(){}get checked(){return this._checked}set checked(t){t!==this._checked&&(null!==this.checkGroup&&t&&this.stage.checkBoxGroupController.notifyCheck(this),this._checked=t,this.change(t))}get value(){return this._value}set value(t){this._value=t,this.checked&&this.stage.checkBoxGroupController.notifyCheck(this)}get selectedValue(){var t;return null===(t=this.stage)||void 0===t?void 0:t.checkBoxGroupController.getSelected(this.checkGroup).value}initialize(){super.initialize();const t=this.eventBroker.click;t.onHover=(t,e)=>{this.emit("hover",e)},t.onPress=(t,e)=>{e&&(this.focus(),t.data.originalEvent.preventDefault()),this.emit("press",e)},t.onClick=()=>{this.click()},null!==this.checkGroup&&this.stage.checkBoxGroupController.in(this,this.checkGroup)}},t.ClickManager=a,t.Ease=I,t.EventBroker=l,t.EventManager=r,t.FastLayout=w,t.FastLayoutOptions=C,t.FocusableWidget=y,t.Helpers=R,t.ImageButton=class extends b{constructor(t){if(super(t),!(t.icon instanceof H)){const i=t.icon instanceof e.Texture?t.icon:e.Texture.from(t.icon);t.icon=new H(i)}this.textWidget.setLayoutOptions(null),this.iconWidget=t.icon,this.removeChild(this.textWidget),this.addChild(this.iconWidget),this.addChild(this.textWidget),this.useLayout(new z("vertical"))}},t.ImageWidget=H,t.Insets=n,t.InteractiveGroup=_,t.LayoutOptions=M,t.LinearLayout=z,t.ScrollBar=at,t.ScrollManager=u,t.ScrollWidget=dt,t.SliceSprite=class extends m{constructor(t,e,i,s,h){super(t.width,t.height),this.bw=e||5,this.vs=void 0===s||s,this.hs=void 0===i||i,this.t=t.baseTexture,this.f=t.frame,this.tile=h,this.hs&&(this.setting.minWidth=2*e),this.vs&&(this.setting.minHeight=2*e),this.update=function(){this.initialized&&(vs&&hs?(str.x=sbr.x=sr.x=this._width-bw,sbl.y=sbr.y=sb.y=this._height-bw,sf.width=st.width=sb.width=this._width-2*bw,sf.height=sl.height=sr.height=this._height-2*bw):hs?(sr.x=this._width-bw,sl.height=sr.height=sf.height=this._height,sf.width=this._width-2*bw):(sb.y=this._height-bw,st.width=sb.width=sf.width=this._width,sf.height=this._height-2*bw),null!==this.tint&&(sf.tint=this.tint,vs&&hs&&(stl.tint=str.tint=sbl.tint=sbr.tint=this.tint),hs&&(sl.tint=sr.tint=this.tint),vs&&(st.tint=sb.tint=this.tint)),null!==this.blendMode&&(sf.blendMode=this.blendMode,vs&&hs&&(stl.blendMode=str.blendMode=sbl.blendMode=sbr.blendMode=this.blendMode),hs&&(sl.blendMode=sr.blendMode=this.blendMode),vs&&(st.blendMode=sb.blendMode=this.blendMode)))}}initialize(){super.initialize();const{f:t,bw:i}=this;this.vs&&this.hs?(this.ftl=new e.Rectangle(t.x,t.y,i,i),this.ftr=new e.Rectangle(t.x+t.width-i,t.y,i,i),this.fbl=new e.Rectangle(t.x,t.y+t.height-i,i,i),this.fbr=new e.Rectangle(t.x+t.width-i,t.y+t.height-i,i,i),this.ft=new e.Rectangle(t.x+i,t.y,t.width-2*i,i),this.fb=new e.Rectangle(t.x+i,t.y+t.height-i,t.width-2*i,i),this.fl=new e.Rectangle(t.x,t.y+i,i,t.height-2*i),this.fr=new e.Rectangle(t.x+t.width-i,t.y+i,i,t.height-2*i),this.ff=new e.Rectangle(t.x+i,t.y+i,t.width-2*i,t.height-2*i)):this.hs?(this.fl=new e.Rectangle(this.f.x,t.y,i,t.height),this.fr=new e.Rectangle(t.x+t.width-i,t.y,i,t.height),this.ff=new e.Rectangle(t.x+i,t.y,t.width-2*i,t.height)):(this.ft=new e.Rectangle(t.x,t.y,t.width,i),this.fb=new e.Rectangle(t.x,t.y+t.height-i,t.width,i),this.ff=new e.Rectangle(t.x,t.y+i,t.width,t.height-2*i));const{t:s,ff:h,fl:n,fr:o,ft:r,fb:a}=this;this.sf=this.tile?new e.TilingSprite(new e.Texture(s,h)):new e.Sprite(new e.Texture(s,h)),this.contentContainer.addChildAt(this.sf,0),this.vs&&this.hs&&(this.stl=new e.Sprite(new e.Texture(s,this.ftl)),this.str=new e.Sprite(new e.Texture(s,this.ftr)),this.sbl=new e.Sprite(new e.Texture(s,this.fbl)),this.sbr=new e.Sprite(new e.Texture(s,this.fbr)),this.contentContainer.addChildAt(this.stl,0),this.contentContainer.addChildAt(this.str,0),this.contentContainer.addChildAt(this.sbl,0),this.contentContainer.addChildAt(this.sbr,0)),hs&&(this.sl=this.tile?new e.TilingSprite(new e.Texture(s,n)):new e.Sprite(new e.Texture(s,n)),this.sr=this.tile?new e.TilingSprite(new e.Texture(s,o)):new e.Sprite(new e.Texture(s,o)),this.contentContainer.addChildAt(this.sl,0),this.contentContainer.addChildAt(this.sr,0)),this.vs&&(this.st=this.tile?new e.TilingSprite(new e.Texture(s,r)):new e.Sprite(new e.Texture(s,r)),this.sb=this.tile?new e.TilingSprite(new e.Texture(s,a)):new e.Sprite(new e.Texture(s,a)),this.contentContainer.addChildAt(this.st,0),this.contentContainer.addChildAt(this.sb,0)),this.vs&&this.hs&&(this.st.x=i,this.sb.x=i,this.sl.y=i,this.sr.y=i,this.stl.width=i,this.str.width=i,this.sbl.width=i,this.sbr.width=i,this.stl.height=i,this.str.height=i,this.sbl.height=i,this.sbr.height=i),this.hs&&(this.sf.x=this.sl.width=this.sr.width=i),this.vs&&(this.sf.y=this.st.height=this.sb.height=i)}update(){}},t.Slider=Y,t.SortableList=class extends _{constructor(t,e,i){super(0,0),this.desc=void 0!==t&&t,this.tweenTime=e||0,this.tweenEase=i,this.items=[]}addChild(t,e,i){super.addChild(t),-1===this.items.indexOf(t)&&this.items.push(t),"function"==typeof e&&(t._sortListValue=e),"function"==typeof i&&(t._sortListThenByValue=i),t._sortListRnd||(t._sortListRnd=Math.random()),this.sort()}removeChild(t){if(arguments.length>1)for(let t=0;t<arguments.length;t++)this.removeChild(arguments[t]);else{super.removeChild(t);const e=this.items.indexOf(t);-1!==e&&this.items.splice(e,1),this.sort()}}sort(t=!1){clearTimeout(this._sortTimeout),t?this._sort():this._sortTimeout=setTimeout(()=>{this._sort()},0)}_sort(){const t=this.desc;let e=0,i=!0;this.items.sort((function(e,i){let s=e._sortListValue()<i._sortListValue()?t?1:-1:e._sortListValue()>i._sortListValue()?t?-1:1:0;return 0===s&&e._sortListThenByValue&&i._sortListThenByValue&&(s=e._sortListThenByValue()<i._sortListThenByValue()?t?1:-1:e._sortListThenByValue()>i._sortListThenByValue()?t?-1:1:0),0===s&&(s=e._sortListRnd>i._sortListRnd?1:e._sortListRnd<i._sortListRnd?-1:0),s}));for(let t=0;t<this.items.length;t++){const s=this.items[t];i=!i,this.tweenTime>0?rt.fromTo(s,this.tweenTime,{x:s.x,y:s.y},{x:0,y:e},this.tweenEase):(s.x=0,s.y=e),e+=s.height,"function"==typeof s.altering&&s.altering(i)}this.tweenTime>0&&setTimeout(()=>{this.updatesettings(!1,!0)},1e3*this.tweenTime)}},t.Sprite=P,t.Stage=ut,t.Style=ct,t.StyleSheet=gt,t.TEXT_STYLE_PROPERTIES=p,t.TextInput=class extends y{constructor(t){super(t),this.onKeyDown=t=>{if(t.which!==this.ctrlKey&&t.which!==this.cmdKey||(this.ctrlDown=!0),t.which===this.shiftKey&&(this.shiftDown=!0),!t.defaultPrevented){if(13===t.which)return this.insertTextAtCaret("\n"),void t.preventDefault();if(this.ctrlDown){if(65===t.which)return this.select(),void t.preventDefault();if(90===t.which)return this.value!=this._lastValue&&(this.valueEvent=this._lastValue),this.setCaretIndex(this._lastValue.length+1),void t.preventDefault()}if(8===t.which)return this.deleteSelection()||(this.caret._index>0||1===this.chars.length&&this.caret._atEnd)&&(this.caret._atEnd?(this.valueEvent=this.value.slice(0,this.chars.length-1),this.setCaretIndex(this.caret._index)):(this.valueEvent=this.value.slice(0,this.caret._index-1)+this.value.slice(this.caret._index),this.setCaretIndex(this.caret._index-1))),void t.preventDefault();if(46===t.which)return this.deleteSelection()||this.caret._atEnd||(this.valueEvent=this.value.slice(0,this.caret._index)+this.value.slice(this.caret._index+1),this.setCaretIndex(this.caret._index)),void t.preventDefault();if(37!==t.which&&39!==t.which)return!this.multiLine||38!==t.which&&40!==t.which?void 0:(this.vrdd=38===t.which,this.shiftDown?this.hasSelection?(this.de.y=Math.max(0,Math.min(this.textHeightPX,this.de.y+(this.vrdd?-this.lineHeight:this.lineHeight))),this.updateClosestIndex(this.de,!1),Math.abs(this.si-this.ei)<=1?this.setCaretIndex(this.sie?this.si+1:this.si):(this.caret._index=(this.eie?this.ei+1:this.ei)+(this.caret._down?-1:0),this.selectRange(this.caret._down?this.si:this.si-1,this.caret._index))):(this.si=this.caret._index,this.sie=!1,this.de.copyFrom(this.caret),this.de.y=Math.max(0,Math.min(this.textHeightPX,this.de.y+(this.vrdd?-this.lineHeight:this.lineHeight))),this.updateClosestIndex(this.de,!1),this.caret._index=(this.eie?this.ei+1:ei)-(this.vrdd?0:1),this.selectRange(this.vrdd?this.si-1:this.si,this.caret._index),this.caret._down=!this.vrdd):this.hasSelection?this.setCaretIndex(this.vrdd?this.selectionStart:this.selectionEnd+1):(this.ds.copyFrom(this.caret),this.ds.y+=this.vrdd?-this.lineHeight:this.lineHeight,this.ds.x+=1,this.updateClosestIndex(this.ds,!0),this.setCaretIndex(this.sie?this.si+1:this.si)),void t.preventDefault());if(this.rdd=37===t.which,this.shiftDown)if(this.hasSelection){if(this.selectionStart===this.caret._index)if(this.selectionStart===this.selectionEnd&&this.rdd===this.caret._forward)this.setCaretIndex(this.caret._forward?this.caret._index:this.caret._index+1);else{const t=this.rdd?this.caret._index-1:this.caret._index+1;this.selectRange(t,this.selectionEnd),this.caret._index=Math.min(this.chars.length-1,Math.max(0,t))}else{const t=this.rdd?this.caret._index-1:this.caret._index+1;this.selectRange(this.selectionStart,t),this.caret._index=Math.min(this.chars.length-1,Math.max(0,t))}}else{const t=this.caret._atEnd?this.caret._index+1:this.caret._index,e=this.rdd?t-1:t;this.selectRange(e,e),this.caret._index=e,this.caret._forward=!rdd}else this.hasSelection?this.setCaretIndex(this.rdd?this.selectionStart:this.selectionEnd+1):this.setCaretIndex(this.caret._index+(this.rdd?this.caret._atEnd?0:-1:1));t.preventDefault()}},this.keyUpEvent=t=>{t.which!==this.ctrlKey&&t.which!==this.cmdKey||(this.ctrlDown=!1),t.which===this.shiftKey&&(this.shiftDown=!1),this.emit("keyup",t),t.defaultPrevented},this.copyEvent=t=>{if(this.emit("copy",t),!t.defaultPrevented){if(this.hasSelection){(t.clipboardData||window.clipboardData).setData("Text",this.value.slice(this.selectionStart,this.selectionEnd+1))}t.preventDefault()}},this.cutEvent=t=>{this.emit("cut",t),t.defaultPrevented||(this.hasSelection&&(this.copyEvent(t),this.deleteSelection()),t.preventDefault())},this.pasteEvent=t=>{if(this.emit("paste",t),t.defaultPrevented)return;const e=t.clipboardData||window.clipboardData;this.insertTextAtCaret(e.getData("Text")),t.preventDefault()},this.inputEvent=t=>{const e=pt.value;e.length&&(this.insertTextAtCaret(e),pt.value=""),t.preventDefault()},this.inputBlurEvent=t=>{this.blur()},this.focus=()=>{if(!this._isFocused){super.focus();const t=`${this.contentContainer.worldTransform.tx}px`,e=`${this.contentContainer.worldTransform.ty}px`,i=`${this.contentContainer.height}px`,s=`${this.contentContainer.width}px`;pt.setAttribute("style",`position:fixed; left:${t}; top:${e}; height:${i}; width:${s};`),pt.value="",pt.focus(),pt.setAttribute("style","position:fixed; left:-10px; top:-10px; width:0px; height: 0px;"),this.innerContainer.cacheAsBitmap=!1,pt.addEventListener("blur",this.inputBlurEvent,!1),document.addEventListener("keydown",this.onKeyDown,!1),document.addEventListener("keyup",this.keyUpEvent,!1),document.addEventListener("paste",this.pasteEvent,!1),document.addEventListener("copy",this.copyEvent,!1),document.addEventListener("cut",this.cutEvent,!1),pt.addEventListener("input",this.inputEvent,!1),setTimeout(()=>{this.caret.visible||this.selection.visible||this.multiLine||this.setCaretIndex(this.chars.length)},0)}},this.blur=()=>{this._isFocused&&(super.blur(),this.ctrlDown=!1,this.shiftDown=!1,this.hideCaret(),this.clearSelection(),this.chars.length>1&&(this.innerContainer.cacheAsBitmap=!0),pt.removeEventListener("blur",this.inputBlurEvent),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.keyUpEvent),document.removeEventListener("paste",this.pasteEvent),document.removeEventListener("copy",this.copyEvent),document.removeEventListener("cut",this.cutEvent),pt.removeEventListener("input",this.inputEvent),pt.blur()),this.multiLine||this.resetScrollPosition()},this.setCaretIndex=t=>{if(this.caret._atEnd=t>=this.chars.length,this.caret._index=Math.max(0,Math.min(this.chars.length-1,t)),this.chars.length&&t>0){let e=Math.max(0,Math.min(t,this.chars.length-1)),i=this.chars[e];i&&i.wrapped?(this.caret.x=i.x,this.caret.y=i.y):(e=Math.max(0,Math.min(t-1,this.chars.length-1)),i=this.chars[e],this.caret.x=this.chars[e].x+this.chars[e].width,this.caret.y=this.chars[e].lineIndex*this.lineHeight+.5*(this.lineHeight-this.textHeight))}else this.caret.x=0,this.caret.y=.5*(this.lineHeight-this.textHeight);this.scrollToPosition(this.caret),this.showCaret()},this.select=()=>{this.selectRange(0,this.chars.length-1)},this.selectWord=t=>{let e=this.chars.length,i=0;for(let s=0;s<this.chars.length;s++)this.chars[s].wordIndex===t&&(s<e&&(e=s),s>i&&(i=s));this.selectRange(e,i)},this.selectRange=(t,e)=>{if(t>-1&&e>-1){const i=Math.min(t,e,this.chars.length-1),s=Math.min(Math.max(t,e),this.chars.length-1);i===this.selectionStart&&s===this.selectionEnd||(this.hasSelection=!0,this.selection.visible=!0,this.selectionStart=i,this.selectionEnd=s,this.hideCaret(),this.updateSelectionGraphics(),this.updateSelectionColors()),this.focus()}else this.clearSelection()},this.clearSelection=()=>{this.hasSelection&&(this.hasSelection=!1,this.selection.visible=!1,this.selectionStart=-1,this.selectionEnd=-1,this.updateSelectionColors())},this.updateSelectionGraphics=()=>{const t=this.chars[this.selectionStart];if(void 0!==t){let e=t.x,i=t.y,s=0;const h=this.textHeight;let n=t.lineIndex;this.selection.clear();for(let t=this.selectionStart;t<=this.selectionEnd;t++){const o=this.chars[t];o.lineIndex!=n&&(this.drawSelectionRect(e,i,s,h),e=o.x,i=o.y,n=o.lineIndex,s=0),s+=o.width}this.drawSelectionRect(e,i,s,h),this.innerContainer.addChildAt(this.selection,0)}},this.drawSelectionRect=(t,e,i,s)=>{this.selection.beginFill(`0x${this.selectedBackgroundColor.slice(1)}`,1),this.selection.moveTo(t,e),this.selection.lineTo(t+i,e),this.selection.lineTo(t+i,e+s),this.selection.lineTo(t,e+s),this.selection.endFill()},void 0===pt&&(pt=document.createElement("INPUT"),pt.setAttribute("type","text"),pt.setAttribute("id","_pui_tempInput"),pt.setAttribute("style","position:fixed; left:-10px; top:-10px; width:0px; height: 0px;"),document.body.appendChild(pt)),this.options=t,this._dirtyText=!0,this.maxLength=t.maxLength||0,this._value=this._lastValue=t.value||"",this.maxLength&&(this._value=this._value.slice(0,this.maxLength)),this.chars=[],this.multiLine=void 0!==t.multiLine&&t.multiLine,this.color=t.style&&t.style.fill?t.style.fill:"#000000",this.selectedColor=t.selectedColor||"#ffffff",this.selectedBackgroundColor=t.selectedBackgroundColor||"#318cfa",this.tempText=new e.Text("1",t.style),this.textHeight=this.tempText.height,this.lineHeight=t.lineHeight||this.textHeight||this._height,this.tempText.destroy(),this.selection=new e.Graphics,this.selection.visible=!1,this.selection._startIndex=0,this.selection._endIndex=0,this.caret=new e.Graphics,this.caret.visible=!1,this.caret._index=0,this.caret.lineStyle(t.caretWidth||1,"#ffffff",1),this.caret.moveTo(0,0),this.caret.lineTo(0,this.textHeight);const i=void 0!==t.paddingLeft?t.paddingLeft:t.padding,s=void 0!==t.paddingRight?t.paddingRight:t.padding,h=void 0!==t.paddingBottom?t.paddingBottom:t.padding,n=void 0!==t.paddingTop?t.paddingTop:t.padding;this.textContainer=new dt({scrollX:!this.multiLine,scrollY:this.multiLine,dragScrolling:this.multiLine,expandMask:2,softness:.2,overflowX:40,overflowY:40}).setPadding(i||3,n||3,s||3,h||3).setLayoutOptions(new M(M.FILL_PARENT,M.FILL_PARENT)),this.addChild(this.textContainer),this.multiLine&&(this._useNext=this._usePrev=!1,this.textContainer.dragRestrictAxis="y",this.textContainer.dragThreshold=5,this.dragRestrictAxis="x",this.dragThreshold=5),this.sp=new e.Point,this._sp=new e.Point,this.ds=new e.Point,this.de=new e.Point,this.rdd=!1,this.vrdd=!1,this.selectionStart=-1,this.selectionEnd=-1,this.hasSelection=!1,this.t=performance.now(),this.cc=0,this.textLengthPX=0,this.textHeightPX=0,this.lineIndexMax=0,this.ctrlDown=!1,this.shiftDown=!1,this.shiftKey=16,this.ctrlKey=17,this.cmdKey=91,this.setupDrag()}setupDrag(){const t=new d(this);t.onPress=(t,e)=>{if(e){const e=performance.now()-this.t;if(this.t=performance.now(),e<250)if(this.cc++,this.cc>1)this.select();else{this.innerContainer.toLocal(this.sp,void 0,this.ds,!0),this.updateClosestIndex(this.ds,!0);const t=this.chars[this.si];t&&(-1!=t.wordIndex?this.selectWord(t.wordIndex):this.selectRange(this.si,this.si))}else this.cc=0,this.sp.copyFrom(t.data.global),this.innerContainer.toLocal(this.sp,void 0,this.ds,!0),this.chars.length&&(this.updateClosestIndex(this.ds,!0),this.setCaretIndex(this.sie?this.si+1:this.si))}t.data.originalEvent.preventDefault()},t.onDragMove=(t,e)=>{this.chars.length&&this._isFocused&&(this.de.x=this.sp.x+e.x,this.de.y=this.sp.y+e.y,this.innerContainer.toLocal(this.de,void 0,this.de,!0),this.updateClosestIndex(this.de,!1),this.si<this.ei?(this.selectRange(this.sie?this.si+1:this.si,this.eie?this.ei:this.ei-1),this.caret._index=this.eie?this.ei:this.ei-1):this.si>this.ei?(this.selectRange(this.ei,this.sie?this.si:this.si-1),this.caret._index=this.ei):this.sie===this.eie?this.setCaretIndex(this.sie?this.si+1:this.si):(this.selectRange(this.si,this.ei),this.caret._index=this.ei),this.caret._forward=this.si<=this.ei,this.caret._down=e.y>0,this.scrollToPosition(this.de))}}get innerContainer(){return this.textContainer.innerContainer.insetContainer}update(){this.width!==this._lastWidth&&(this._lastWidth=this._width,this.multiLine&&(this.updateText(),this.caret.visible&&this.setCaretIndex(this.caret._index),this.hasSelection&&this.updateSelectionGraphics())),this._dirtyText&&(this.updateText(),this._dirtyText=!1)}updateText(){this.textLengthPX=0,this.textHeightPX=0,this.lineIndexMax=0;let t=0;const i=this._value.length;let s=0,h=.5*(this.lineHeight-this.textHeight),n=0;if(this.chars.length>i){for(n=this.chars.length-1;n>=i;n--)this.innerContainer.removeChild(this.chars[n]),this.chars[n].destroy();this.chars.splice(i,this.chars.length-i)}let o=!1,r=!1,a=0,d=-1,l=!1;for(n=0;n<this._value.length;n++){(o||r)&&(d=n,a++);let i=this._value[n];o=" "===i,r="\n"===i,r&&(i="");let u=this.chars[n];u?u.text=i:(u=new e.Text(i,this.options.style),this.innerContainer.addChild(u),this.chars.push(u)),u.scale.x=r?0:1,u.wrapped=l,l=!1,!(r||this.multiLine&&s+u.width>=this._width-this.paddingLeft-this.paddingRight)||(t++,s=0,h+=this.lineHeight,-1===d||r)?(u.lineIndex=t,u.x=s,u.y=h,u.wordIndex=o||r?-1:a,s+=u.width,s>this.textLengthPX&&(this.textLengthPX=s),h>this.textHeightPX&&(this.textHeightPX=h)):(n=d-1,d=-1,l=!0)}this.lineIndexMax=t,this.innerContainer.addChild(this.caret),this.innerContainer.cacheAsBitmap&&(this.innerContainer.cacheAsBitmap=!1,this.innerContainer.cacheAsBitmap=!0),this.textContainer.update()}updateClosestIndex(t,e){let i=99999,s=-1,h=!1,n=0;this.lineIndexMax>0&&(n=Math.max(0,Math.min(this.lineIndexMax,Math.floor(t.y/this.lineHeight))));for(let e=0;e<this.chars.length;e++){const o=this.chars[e];if(o.lineIndex!==n)continue;const r=Math.abs(t.x-(o.x+.5*o.width));r<i&&(i=r,s=e,h=t.x>o.x+.5*o.width)}e?(this.si=s,this.sie=h):(this.ei=s,this.eie=h)}deleteSelection(){return!!this.hasSelection&&(this.value=this.value.slice(0,this.selectionStart)+this.value.slice(this.selectionEnd+1),this.setCaretIndex(this.selectionStart),!0)}updateSelectionColors(){for(let t=0;t<this.chars.length;t++)t>=this.selectionStart&&t<=this.selectionEnd?this.chars[t].style.fill=this.selectedColor:this.chars[t].style.fill=this.color}scrollToPosition(t){this._sp.x=t.x,this._sp.y=t.y,this.multiLine&&this._sp.y>=this.lineHeight&&(this._sp.y+=this.lineHeight),this.textContainer.focusPosition(this._sp)}resetScrollPosition(){this._sp.set(0,0),this.textContainer.focusPosition(this._sp)}hideCaret(){this.caret.visible=!1,clearInterval(this.caretInterval)}showCaret(){this.clearSelection(),clearInterval(this.caretInterval),this.caret.alpha=1,this.caret.visible=!0,this.caretInterval=setInterval(()=>{this.caret.alpha=0===this.caret.alpha?1:0},500)}insertTextAtCaret(t){if(this.multiLine||-1===t.indexOf("\n")||(t=t.replace(/\n/g,"")),this.hasSelection&&this.deleteSelection(),!this.maxLength||this.chars.length<this.maxLength)if(this.caret._atEnd)this.valueEvent+=t,this.setCaretIndex(this.chars.length);else{const e=Math.min(this.chars.length-1,this.caret._index);this.valueEvent=this.value.slice(0,e)+t+this.value.slice(e),this.setCaretIndex(e+t.length)}}get valueEvent(){return this._value}set valueEvent(t){this.maxLength&&(t=t.slice(0,this.maxLength)),this._value!=t&&(this.value=t,this.emit("change"))}get value(){return this._value}set value(t){this.maxLength&&(t=t.slice(0,this.maxLength)),this._value!=t&&(this._lastValue=this._value,this._value=t,this._dirtyText=!0,this.update())}get text(){return this.value}set text(t){this.value=t}},t.TextWidget=T,t.Ticker=mt,t.TilingSprite=class extends m{constructor(t,i,s){const h=new e.TilingSprite(t);super(i||h.width,s||h.height),this.sprite=h,this.contentContainer.addChild(this.sprite)}update(){null!==this.tint&&(this.sprite.tint=this.tint),null!==this.blendMode&&(this.sprite.blendMode=this.blendMode),this.sprite.width=this._width,this.sprite.height=this._height}get tilePosition(){return this.sprite.tilePosition}set tilingPosition(t){this.sprite.tilePosition=t}get tileScale(){return this.sprite.tileScale}set tileScale(t){this.sprite.tileScale=t}},t.Widget=m,t.WidgetGroup=x,t.create=A,t.wrapEase=O,t}({},PIXI,__filters);Object.assign(this.PUXI,_puxi_core);
//# sourceMappingURL=puxi-core.min.js.map
